import{F as B,_ as A,d as L,i as k,a as I,t as ne,c as g,o as V,b as P,e as p,f as N,u as F,g as z,h as oe,p as S,r as T,w as O,j as D,k as se,l as ae,m as J,v as W,n as re,q as le,s as ce,x as H,y as X,z as K,A as ie,B as de,C as ue,D as pe}from"./index.47cb9150.js";function q(r){const v=/[\\]?@{([\w\s.]*)}/g;function h(n){const o={};for(let c=0;c<n.length-1;c++){const s=n[c],{componentId:i}=s,{type:e}=r.getComponentById(i);if(e!=="repeater"||c+1>=n.length)continue;const t=n.slice(0,c+1),d=n.slice(0,c+2),{instanceNumber:u}=d.at(-1),b=_(t,"repeaterObject"),C=Object.entries(b),E=_(t,"keyVariable"),M=_(t,"valueVariable");o[E]=C[u][0],o[M]=C[u][1]}return o}function l(n,o){if(n==null)return null;let c;const s=h(o),i=n.replace(v,(t,d)=>{if(t.charAt(0)=="\\")return t.substring(1);const u=d.trim();if(!u)return;const b=r.evaluateExpression(u,s);if(typeof b!="undefined"){if(u===t){c=b;return}return typeof b=="object"?JSON.stringify(b):b}});return typeof c=="undefined"?i:c}function m(n){const{componentId:o}=n.at(-1),c=r.getComponentById(o);if(!c)return;const s={},{fields:i}=r.getComponentDefinition(c.type);if(!!i)return Object.keys(i).forEach(e=>{s[e]=_(n,e)}),s}function _(n,o){var b;const{componentId:c}=n.at(-1),s=r.getComponentById(c),{fields:i}=r.getComponentDefinition(s.type),e=(b=s.content)==null?void 0:b[o],t=i[o].default,d=l(e,n),u=i[o].type;if(u==B.Object||u==B.KeyValue){if(!d)return t?JSON.parse(t):null;if(typeof d!="string")return d;let C;try{C=JSON.parse(d)}catch{return t?JSON.parse(t):null}return C}else if(u==B.Number){const C=parseFloat(d);return typeof C===void 0||Number.isNaN(C)?parseFloat(t):C}else if(u==B.Text||B.Color)return typeof e=="undefined"||e===null||e===""?t:d}return{getEvaluatedFields:m}}const ve={class:"ChildlessPlaceholder"},_e={class:"content"},me={class:"title"},fe={key:0,class:"message"},ge=L({__name:"ChildlessPlaceholder",props:{componentId:null},setup(r){const v=r,h=10,l=k(I.core),{componentId:m}=ne(v),_=g(()=>l.getComponentById(m.value)),n=g(()=>l.getComponentDefinition(_.value.type)),o=(s,i)=>{const t=s.map(u=>l.getComponentDefinition(u)).map(u=>u==null?void 0:u.name);return`${t.slice(0,-1).join(", ")} ${t.length>1?i:""} ${t.at(-1)}`},c=g(()=>{const s=l.getContainableTypes(m.value);let i;return s.length<=h&&(i=`You can add ${o(s,"and")} components`),i});return(s,i)=>(V(),P("div",ve,[p("div",_e,[p("div",me,[p("h2",null,"Empty "+N(F(n).name),1)]),F(c)?(V(),P("div",fe,N(F(c)),1)):z("",!0)])]))}});var he=A(ge,[["__scopeId","data-v-0ac82581"]]);const ye=r=>D("div",`Component type ${r} not supported.`),Ce={props:["componentId","instancePath","instanceData"],setup(r){const v=k(I.core),h=k(I.builderManager),l=r.componentId,m=g(()=>v.getComponentById(l)),_=oe[m.value.type];if(!_)return ye(m.value.type);const n=r.instancePath,o=r.instanceData,c=q(v),s=g(()=>c.getEvaluatedFields(n)),i=g(()=>v.getComponents(l,!0)),e=g(()=>!!h&&h.getMode()!="preview"),t=()=>{if(!(i.value.length>0))return D(he,{componentId:m.value.id})},d=(a,f=0)=>D(G,{componentId:a,key:`${a}:${f}`,instancePath:[...n,{componentId:a,instanceNumber:f}],instanceData:[...o,T(null)]}),u=(a=0,f=()=>!0,y=!1)=>{const x=$=>D("div",{"data-streamsync-slot-of-id":l,"data-streamsync-position":$}),w=e.value&&!y,j=i.value.filter(f).map(($,te)=>[d($.id,a),...w?[x(te+1)]:[]]);return[...w?[x(0)]:[]].concat(j.flat())};S(I.evaluatedFields,s),S(I.componentId,l),S(I.formValue,g({get(){return v.getFormValue(l)},set(a){v.setFormValue(l,a)}})),S(I.instancePath,n),S(I.instanceData,o),S(I.renderProxiedComponent,d),S(I.getChildrenVNodes,u);const C={"data-streamsync-id":l,"data-streamsync-instance-path":(a=>a.map(f=>`${f.componentId}:${f.instanceNumber}`).join(","))(n)},E=T(!1);O(()=>(h==null?void 0:h.getSelectedId())==l,a=>{E.value=a}),O(s,()=>{E.value=!1});const M=g(()=>i.value.length==0),U=g(()=>v.isComponentVisible(l)),Y=a=>{if(!a.startsWith("$"))return y=>v.forwardEvent(y,n);if(a.startsWith("$goToPage_")){const y=a.substring(10);return x=>v.setActivePageFromKey(y)}return null},Q=g(()=>{const a={};return Object.entries(m.value.handlers).forEach(([f,y])=>{const x=`on${f.charAt(0).toUpperCase()}${f.slice(1)}`;a[x]=Y(y)}),a}),Z=g(()=>{var y;const a=(y=v.getComponentDefinition(m.value.type))==null?void 0:y.fields;if(!a)return;const f={};return Object.keys(a).forEach(x=>{!a[x].applyStyleVariable||!s.value[x]||(f[`--${x}`]=s.value[x])}),f}),ee=function(){return{class:{component:!0,childless:M.value,selected:E.value},style:{...Z.value,...U.value?{}:{display:"none"}},...C,...Q.value,draggable:e.value}};return()=>{const a=e.value?t():void 0,f=({instanceNumber:w,componentFilter:j,positionlessSlot:$})=>M.value?$?void 0:a:u(w,j,$),y={...ee()};return D(_,y,{default:f})}}};var G=A(Ce,[["__scopeId","data-v-764a7c5e"]]);const R=r=>(X("data-v-2ef8a086"),r=r(),K(),r),Ie=R(()=>p("i",{class:"ri-notification-2-line ri-xl"},null,-1)),be={class:"counter"},xe=R(()=>p("div",{class:"balloonFlash"},null,-1)),Se={class:"main"},Ve=R(()=>p("i",{class:"ri-close-line"},null,-1)),$e=R(()=>p("i",{class:"ri-error-warning-fill ri-xl"},null,-1)),Ne=[$e],Pe={class:"content"},Te={class:"title"},Ee={class:"time"},Be={class:"message"},De=L({__name:"RendererNotifications",setup(r){const h=k(I.core),l=T(!1),m=T(null),_=se([]),n=s=>{const{type:i,title:e,message:t,code:d}=s;_.unshift({type:i,title:e,message:t,code:d,timestampReceived:new Date}),_.splice(100),m.value.classList.remove("alert"),m.value.offsetWidth,m.value.classList.add("alert")};ae(()=>{h.addMailSubscription("notification",n)});const o=()=>{_.length!=0&&(l.value=!l.value)},c=()=>{_.splice(0),l.value=!1};return(s,i)=>J((V(),P("div",{class:"RendererNotifications",onClick:o},[p("div",{class:"balloon",ref_key:"balloon",ref:m,title:"Toggle notifications"},[Ie,p("div",be,N(_.length),1)],512),xe,J(p("div",Se,[p("div",{class:"clearContainer"},[p("button",{onClick:c},[Ve,re(" Clear all ")])]),(V(!0),P(le,null,ce(_,(e,t)=>(V(),P("div",{class:"notification",key:t},[p("div",{class:H(["icon",e.type])},Ne,2),p("div",Pe,[p("header",null,[p("strong",Te,N(e.title),1),p("span",Ee,N(e.timestampReceived.toLocaleTimeString()),1)]),p("div",Be,N(e.message),1)])]))),128))],512),[[W,l.value]])],512)),[[W,_.length>0]])}});var Fe=A(De,[["__scopeId","data-v-2ef8a086"]]);const ke=r=>(X("data-v-18d44360"),r=r(),K(),r),Me=ke(()=>p("div",{class:"loadingBar"},null,-1)),we={class:"rootComponentArea"},Ae=L({__name:"ComponentRenderer",setup(r){const v=k(I.core),h=q(v),l=v.getComponents();l.length==0&&console.error("No pages found.");const m=[{componentId:"root",instanceNumber:0}],_=[T(null)],n=T(l[0]),o=g(()=>h.getEvaluatedFields(m)),c=g(()=>({"--accentColor":o.value.accentColor,"--emptinessColor":o.value.emptinessColor,"--containerBackgroundColor":o.value.parentIdBackgroundColor,"--primaryTextColor":o.value.primaryTextColor,"--secondaryTextColor":o.value.secondaryTextColor,"--separatorColor":o.value.separatorColor})),s=g(()=>v.isCallbackPending.value);O(()=>o.value.appName,e=>{i(e)},{immediate:!0});function i(e){const t=v.getMode();let d;e&&t=="edit"?d=`${e} | Streamsync Builder`:!e&&t=="edit"?d="Streamsync Builder":e&&t=="run"?d=`${e}`:!e&&t=="run"&&(d="Streamsync App"),document.title=d}return(e,t)=>(V(),P("div",{class:H(["ComponentRenderer",{loadingActive:F(s)}]),tabindex:"-1",style:pe(F(c))},[ie(Fe,{class:"notifications"}),Me,p("div",we,[n.value?(V(),de(G,{key:0,"component-id":n.value.id,"instance-path":m,"instance-data":_},null,8,["component-id"])):z("",!0),ue(e.$slots,"default",{},void 0,!0)])],6))}});var Oe=A(Ae,[["__scopeId","data-v-18d44360"]]);export{Oe as default};
