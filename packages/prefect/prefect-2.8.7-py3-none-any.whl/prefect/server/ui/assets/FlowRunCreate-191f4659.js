import{ar as D,d as k,M as x,B as N,as as O,c,at as b,$ as B,h as a,a as F,w as d,n as I,b as M,e as V,o as J,g as i,au as P,av as T,aw as $,ax as A,z as y,ap as f}from"./index-8c2645e8.js";import{u as U}from"./usePageTitle-c65d4e12.js";class q extends D{parse(t){return JSON.parse(decodeURIComponent(t??""))}format(t){return encodeURIComponent(JSON.stringify(t))}}const j=k({__name:"FlowRunCreate",setup(w){const t=x(),s=N("deploymentId"),n=V(),m=O("parameters",q,void 0),R=c(()=>!e.value||!m.value?{}:b.map("SchemaValuesResponse",{schema:e.value.parameterOpenApiSchema,values:m.value},"SchemaValues")),h=B(t.deployments.getDeployment,[s]),e=c(()=>h.response),v=async r=>{var l,o;try{const u=await t.deployments.createDeploymentFlowRun(s.value,r),p=((o=(l=r.state)==null?void 0:l.stateDetails)==null?void 0:o.scheduledTime)??void 0,g=!p,S=$(A,{flowRun:u,flowRunRoute:y.flowRun,router:n,immediate:g,startTime:p});f(S,"success"),n.push(y.deployment(s.value))}catch(u){f("Something went wrong trying to create a flow run","error"),console.error(u)}},_=()=>{n.back()},C=c(()=>e.value?`Create Flow Run for Deployment: ${e.value.name}`:"Create Flow Run for Deployment");return U(C),(r,l)=>{const o=M("p-layout-default");return a(e)?(J(),F(o,{key:0},{header:d(()=>[i(a(P),{deployment:a(e)},null,8,["deployment"])]),default:d(()=>[i(a(T),{deployment:a(e),parameters:a(R),onSubmit:v,onCancel:_},null,8,["deployment","parameters"])]),_:1})):I("",!0)}}});export{j as default};
