import{P as h,d,r as m,a6 as p,c as l,z as v,h as y,i as $,w as _,l as k,b as M,M as T,k as U,Q as s,n as S}from"./index-f1dee0d3.js";import{b as B}from"./VBtn-2a3e9582.js";import{b as x}from"./VCardText-b7410ff5.js";const V=t=>t==null||!t?!1:typeof t=="boolean"?t:!!JSON.parse(String(t).toLowerCase()),j=function(t){t=Math.floor(t);const a=Math.floor(t/3600),n=Math.floor((t-a*3600)/60),i=t-a*3600-n*60;let e=a.toString(),r=n.toString(),u=i.toString();return a<10&&(e="0"+a),n<10&&(r="0"+n),i<10&&(u="0"+i),e==="00"?r+":"+u:e+":"+r+":"+u},g=function(t,a){return t?t.length<=a?t:t.slice(0,a)+"...":""},D=function(t){return t?t.map(a=>a.name).join(" / "):""},O=function(t,a){let n="";return t!=null&&t.name&&(t!=null&&t.label)?n=`${t.name}: ${a(t==null?void 0:t.label)}`:t!=null&&t.name?n=t.name:t!=null&&t.label?n=a(t==null?void 0:t.label):n=t.path||"",n},q=function(t,a=26){return t?t.type!=h.GROUP&&t.group_childs.length>0?`${g(t.display_name,a-3)} +${t.group_childs.length}`:g(t.display_name,a):""},C={class:"d-flex align-center justify-center fill-height"},N=function(t,a=s.THUMB,n=!1){if(t){if("metadata"in t&&t.metadata.images){for(const i of t.metadata.images)if(!(i.is_file&&!n)&&i.type==a)return i}if("album"in t&&t.album&&"metadata"in t.album&&t.album.metadata&&t.album.metadata.images){for(const i of t.album.metadata.images)if(!(i.is_file&&!n)&&i.type==a)return i}if("artist"in t&&"metadata"in t.artist&&t.artist.metadata&&t.artist.metadata.images){for(const i of t.artist.metadata.images)if(!(i.is_file&&!n)&&i.type==a)return i}if("artists"in t&&t.artists){for(const i of t.artists)if("metadata"in i&&i.metadata.images){for(const e of i.metadata.images)if(!(e.is_file&&!n)&&e.type==a)return e}}}},P=async function(t,a=s.THUMB,n){var e;if(!t)return;let i="";if("image_url"in t&&t.image_url)i=t.image_url;else{const r=N(t,a,!0);if(!r)return;if(r.is_file){const u=encodeURIComponent(encodeURIComponent(r.url)),f="metadata"in t?(e=t.metadata)==null?void 0:e.checksum:"";return`${S.baseUrl}/imageproxy?size=${n||0}&path=${u}&checksum=${f}`}i=r.url}return n?`https://images.weserv.nl/?url=${i}&w=${n}&h=${n}&fit=cover&a=attention`:i},A=d({__name:"MediaItemThumb",props:{item:null,width:{default:"100%"},height:{default:"auto"},aspectRatio:{default:"1/1"},cover:{type:Boolean,default:!0},fallback:{default:void 0},thumb:{type:Boolean,default:!0}},setup(t){const a=t,n=m(),i=p(),e=l(()=>a.fallback?a.fallback:a.item?i.current.value.dark?`https://ui-avatars.com/api/?name=${a.item.name}&size=${r.value||256}&bold=true&background=1d1d1d&color=383838`:`https://ui-avatars.com/api/?name=${a.item.name}&size=${r.value||256}&bold=true&background=a0a0a0&color=cccccc`:""),r=l(()=>typeof a.width=="number"?a.width:a.thumb?256:0);return v(()=>a.item,async u=>{u&&(n.value=await P(u,s.THUMB,r.value)||e.value)},{immediate:!0}),(u,f)=>{var o,c;return y(),$(x,{key:"uri"in t.item?(o=t.item)==null?void 0:o.uri:(c=t.item)==null?void 0:c.queue_item_id,style:T(`height:${t.height};`),cover:t.cover,src:n.value,width:t.width,"aspect-ratio":t.aspectRatio,onError:f[0]||(f[0]=()=>{n.value=U(e)})},{placeholder:_(()=>[k("div",C,[M(B,{indeterminate:""})])]),_:1},8,["style","cover","src","width","aspect-ratio"])}}});export{A as _,D as a,P as b,O as c,j as f,q as g,V as p,g as t};
