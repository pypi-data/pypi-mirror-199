import{_ as I,f as h}from"./ItemsListing.vue_vue_type_script_setup_true_lang-6f6883bf.js";import{_ as y}from"./InfoHeader.vue_vue_type_style_index_0_lang-f0d81c41.js";import{d as E,r as p,z as g,o as A,n as d,V,A as M,h as v,q as B,b as c,w as k,i as b,j as C,v as $,p as T}from"./index-6b8e9665.js";import{V as x,a as N}from"./VTabs-99682bd6.js";import{V as U}from"./VDivider-eaeef5d4.js";import"./vue-virtual-scroller.esm-1d586c71.js";/* empty css                             */import"./ListviewItem-d7abb943.js";import"./_plugin-vue_export-helper-6250856a.js";import"./MediaItemThumb.vue_vue_type_style_index_0_lang-bf526eac.js";import"./VBtn-78ffa2a3.js";import"./VCardText-3c6786ab.js";import"./ProviderIcon.vue_vue_type_script_setup_true_lang-fa2998bf.js";import"./VCard-a22457ec.js";import"./forwardRefs-5242d0a6.js";import"./VMenu-c38191cf.js";import"./VLabel-d92bd734.js";import"./VCheckboxBtn-f98fa7cc.js";import"./VTooltip-f86f9b47.js";import"./MediaItemContextMenu.vue_vue_type_style_index_0_lang-59990fbf.js";import"./VToolbar-acf511e0.js";import"./VSelect-2ae84853.js";import"./VDialog-e023b317.js";import"./VRow-ea08c5c4.js";/* empty css              */import"./VAlert-ab5bd938.js";import"./layout-fac2351e.js";const ne=E({__name:"TrackDetails",props:{itemId:null,provider:null},setup(w){const o=w,s=p(""),l=p(!1),r=p(),u=p(!0),f=async function(){r.value=await d.getTrack(o.itemId,o.provider),s.value="versions"};g(()=>o.itemId,t=>{t&&f()},{immediate:!0}),A(()=>{const t=d.subscribe_multi([V.MEDIA_ITEM_ADDED,V.MEDIA_ITEM_UPDATED],e=>{var m,n,i;const a=e.data;if(((m=r.value)==null?void 0:m.uri)==a.uri)l.value=!0;else for(const _ of a.provider_mappings)if(_.provider_domain==((n=r.value)==null?void 0:n.provider)&&_.item_id==((i=r.value)==null?void 0:i.item_id)){l.value=!0;break}});M(t)});const D=async function(t,e,a,m,n=!0){const i=await d.getTrackVersions(o.itemId,o.provider);return u.value=i.length>0,h(i,t,e,a,m,n)};return(t,e)=>(v(),B("section",null,[c(y,{item:r.value},null,8,["item"]),c(N,{modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=a=>s.value=a),"show-arrows":"",grow:"","hide-slider":""},{default:k(()=>[u.value?(v(),b(x,{key:0,value:"details"},{default:k(()=>[C($(t.$t("other_versions")),1)]),_:1})):T("",!0)]),_:1},8,["modelValue"]),c(U),u.value&&s.value=="versions"?(v(),b(I,{key:0,itemtype:"trackversions","parent-item":r.value,"show-providers":!0,"show-library":!1,"show-track-number":!1,"load-data":D,"sort-keys":["provider","sort_name","duration"],"update-available":l.value,onRefreshClicked:e[1]||(e[1]=a=>{f(),l.value=!1})},null,8,["parent-item","update-available"])):T("",!0)]))}});export{ne as default};
