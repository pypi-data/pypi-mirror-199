import{d as Q,f as ee,e as te,r as T,c as x,s as I,n as s,o as ie,V as E,A as le,z as ae,h as d,q as f,b as t,w as o,j as y,v as u,k as n,l as p,i as q,p as c,ah as C,N as P,m as F}from"./index-6b8e9665.js";import{s as oe}from"./vue-virtual-scroller.esm-1d586c71.js";/* empty css                             */import{_ as ne,f as ue,t as se}from"./MediaItemThumb.vue_vue_type_style_index_0_lang-bf526eac.js";import{V as G,a as de}from"./VTabs-99682bd6.js";import{V as H}from"./VAlert-ab5bd938.js";import{V as g,a as k,c as re}from"./VCardText-3c6786ab.js";import{V as J}from"./VTooltip-f86f9b47.js";import{a as M,V}from"./VBtn-78ffa2a3.js";import{V as b}from"./VDivider-eaeef5d4.js";import{a as me}from"./VCard-a22457ec.js";import{V as pe,b as W}from"./VToolbar-acf511e0.js";import{V as _e}from"./forwardRefs-5242d0a6.js";import{V as ve}from"./VDialog-e023b317.js";const fe={style:{"padding-left":"15px","padding-right":"-15px","padding-top":"10px","padding-bottom":"20px"}},ce=p("br",null,null,-1),ge={key:0},be={class:"listitem-thumb"},ye={key:0},qe={key:1},Ce={key:2},ke={class:"listitem-actions"},Ve={key:0,class:"listitem-action"},$e={key:1,class:"listitem-action"},we={key:2,class:"listitem-action"},Le=Q({__name:"PlayerQueue",setup(he){const{t:X}=ee(),B=te(),U=T(0),r=T(),D=T(!1),$=T([]);T(0);const e=x(()=>{if(I.selectedPlayer)return s.queues[I.selectedPlayer.active_queue]}),Y=x(()=>{if(e.value)return e.value.current_item}),N=x(()=>e.value?$.value.slice(e.value.current_index):[]),S=x(()=>e.value?$.value.slice(0,e.value.current_index):[]),Z=x(()=>U.value==1?S.value:N.value);ie(()=>{const l=s.subscribe_multi([E.QUEUE_UPDATED,E.QUEUE_ITEMS_UPDATED],i=>{var h;i.object_id==((h=e.value)==null?void 0:h.queue_id)&&(i.event==E.QUEUE_ITEMS_UPDATED?z():L())});le(l)});const z=async function(){e.value?(I.topBarTitle=e.value.display_name,$.value=await s.getPlayerQueueItems(e.value.queue_id)):(I.topBarTitle=void 0,$.value=[])},R=function(l){r.value=l,D.value=!0},j=function(l){A(),B.push({name:l.media_type,params:{itemId:l.item_id,provider:l.provider}})},w=function(l,i){A(),!(!l||!e.value)&&(i=="play_now"?s.queueCommandPlayIndex(e==null?void 0:e.value.queue_id,l.queue_item_id):i=="move_next"?s.queueCommandMoveNext(e==null?void 0:e.value.queue_id,l.queue_item_id):i=="up"?s.queueCommandMoveUp(e==null?void 0:e.value.queue_id,l.queue_item_id):i=="down"?s.queueCommandMoveDown(e==null?void 0:e.value.queue_id,l.queue_item_id):i=="delete"&&s.queueCommandDelete(e==null?void 0:e.value.queue_id,l.queue_item_id))},L=function(){I.topBarContextMenuItems=[{label:"settings.player_settings",labelArgs:[],action:()=>{B.push(`/settings/editplayer/${e.value.queue_id}`)},icon:"mdi-cog-outline"},{label:"queue_clear",labelArgs:[],action:()=>{s.queueCommandClear(e.value.queue_id)},icon:"mdi-cancel"},{label:e.value.shuffle_enabled?"shuffle_enabled":"shuffle_disabled",labelArgs:[],action:()=>{s.queueCommandShuffleToggle(e.value.queue_id)},icon:e.value.shuffle_enabled?"mdi-shuffle":"mdi-shuffle-disabled"},{label:"repeat_mode",labelArgs:[X(`repeatmode.${e.value.repeat_mode}`)],action:()=>{s.queueCommandRepeatToggle(e.value.queue_id)},icon:e.value.shuffle_enabled?"mdi-repeat":"mdi-repeat-off"},{label:e.value.crossfade_enabled?"crossfade_enabled":"crossfade_disabled",labelArgs:[],action:()=>{s.queueCommandCrossfadeToggle(e.value.queue_id)},icon:e.value.crossfade_enabled?"mdi-swap-horizontal-bold":"mdi-swap-horizontal"}]},A=function(){r.value=void 0,D.value=!1};return ae(()=>e.value,l=>{l&&(z(),L())},{immediate:!0}),(l,i)=>{var h;return d(),f("section",null,[t(de,{modelValue:U.value,"onUpdate:modelValue":i[0]||(i[0]=a=>U.value=a),"show-arrows":"",grow:""},{default:o(()=>[t(G,{value:0},{default:o(()=>[y(u(l.$t("queue_next_items")+" ("+n(N).length+")"),1)]),_:1}),t(G,{value:1},{default:o(()=>[y(u(l.$t("queue_previous_items")+" ("+n(S).length+")"),1)]),_:1})]),_:1},8,["modelValue"]),p("div",fe,[n(e)&&((h=n(e))==null?void 0:h.radio_source.length)>0?(d(),q(H,{key:0,color:"primary",theme:"dark",icon:"mdi-radio-tower",prominent:"",style:{"margin-right":"10px"}},{default:o(()=>{var a,v,m,_;return[p("b",null,u(l.$t("queue_radio_enabled")),1),ce,y(" "+u(l.$t("queue_radio_based_on",[l.$t((a=n(e))==null?void 0:a.radio_source[0].media_type)]))+" ",1),p("b",null,[p("a",{onClick:i[1]||(i[1]=K=>{var O;return n(e)?j((O=n(e))==null?void 0:O.radio_source[0]):""})},u((v=n(e))==null?void 0:v.radio_source[0].name),1)]),((m=n(e))==null?void 0:m.radio_source.length)>1?(d(),f("span",ge," (+"+u(((_=n(e))==null?void 0:_.radio_source.length)-1)+")",1)):c("",!0)]}),_:1})):c("",!0),t(n(oe),{items:n(Z),"item-size":66,"key-field":"queue_item_id","page-mode":""},{default:o(({item:a})=>{var v;return[p("div",null,[t(g,{ripple:"",disabled:a.queue_item_id==((v=n(Y))==null?void 0:v.queue_item_id),onClick:C(m=>R(a),["stop"]),onContextmenu:C(m=>R(a),["right","prevent"])},{prepend:o(()=>[p("div",be,[t(ne,{item:a,width:"50px",height:"50px"},null,8,["item"])])]),title:o(()=>[y(u(a.media_item?a.media_item.name:a.name),1)]),subtitle:o(()=>[a.media_item&&"artists"in a.media_item&&a.media_item.artists.length>0?(d(),f("div",ye,u(a.media_item.artists[0].name),1)):a.media_item?(d(),f("div",qe,u(a.media_item.metadata.description),1)):(d(),f("div",Ce,u(a.uri),1))]),append:o(()=>{var m;return[p("div",ke,[a.duration&&((m=a.media_item)==null?void 0:m.media_type)!=n(P).RADIO?(d(),f("div",Ve,[p("span",null,u(n(ue)(a.duration)),1)])):c("",!0),l.$vuetify.display.mobile?c("",!0):(d(),f("div",$e,[t(J,{location:"bottom"},{activator:o(({props:_})=>[t(M,F({variant:"plain",ripple:""},_,{icon:"mdi-arrow-up",onClick:[K=>n(s).queueCommandMoveUp(n(e).queue_id,a.queue_item_id),i[2]||(i[2]=C(()=>{},["prevent"])),i[3]||(i[3]=C(()=>{},["stop"]))]}),null,16,["onClick"])]),default:o(()=>[p("span",null,u(l.$t("queue_move_up")),1)]),_:2},1024)])),l.$vuetify.display.mobile?c("",!0):(d(),f("div",we,[t(J,{location:"bottom"},{activator:o(({props:_})=>[t(M,F({variant:"plain",ripple:""},_,{icon:"mdi-arrow-down",onClick:[K=>n(s).queueCommandMoveDown(n(e).queue_id,a.queue_item_id),i[4]||(i[4]=C(()=>{},["prevent"])),i[5]||(i[5]=C(()=>{},["stop"]))]}),null,16,["onClick"])]),default:o(()=>[p("span",null,u(l.$t("queue_move_down")),1)]),_:2},1024)]))])]}),_:2},1032,["disabled","onClick","onContextmenu"]),t(b)])]}),_:1},8,["items"]),$.value.length==0?(d(),q(H,{key:1,type:"info",style:{margin:"20px"}},{default:o(()=>[y(u(l.$t("no_content")),1)]),_:1})):c("",!0)]),t(ve,{modelValue:D.value,"onUpdate:modelValue":i[13]||(i[13]=a=>D.value=a),fullscreen:l.$vuetify.display.mobile,"min-height":"80%",scrim:!0},{default:o(()=>[t(me,null,{default:o(()=>[t(pe,{sense:"",dark:"",color:"primary"},{default:o(()=>[t(M,{icon:"mdi-play-circle-outline"}),r.value?(d(),q(W,{key:0,style:{"padding-left":"10px"}},{default:o(()=>{var a;return[p("b",null,u(n(se)(((a=r.value)==null?void 0:a.name)||"",l.$vuetify.display.mobile?20:150)),1)]}),_:1})):(d(),q(W,{key:1,style:{"padding-left":"10px"}},{default:o(()=>{var a;return[p("b",null,u(l.$t("settings")),1),y(" | "+u((a=n(e))==null?void 0:a.display_name),1)]}),_:1})),t(M,{icon:"mdi-close",dark:"",text:"",onClick:i[6]||(i[6]=a=>A())})]),_:1}),r.value?(d(),q(re,{key:0},{default:o(()=>[t(_e,null,{default:o(()=>{var a,v;return[t(g,{title:l.$t("play_now"),onClick:i[7]||(i[7]=m=>w(r.value,"play_now"))},{prepend:o(()=>[t(k,{style:{"padding-right":"10px"}},{default:o(()=>[t(V,{icon:"mdi-play-circle-outline"})]),_:1})]),_:1},8,["title"]),t(b),t(g,{title:l.$t("play_next"),onClick:i[8]||(i[8]=m=>w(r.value,"move_next"))},{prepend:o(()=>[t(k,{style:{"padding-right":"10px"}},{default:o(()=>[t(V,{icon:"mdi-skip-next-circle-outline"})]),_:1})]),_:1},8,["title"]),t(b),t(g,{title:l.$t("queue_move_up"),onClick:i[9]||(i[9]=m=>w(r.value,"up"))},{prepend:o(()=>[t(k,{style:{"padding-right":"10px"}},{default:o(()=>[t(V,{icon:"mdi-arrow-up"})]),_:1})]),_:1},8,["title"]),t(b),t(g,{title:l.$t("queue_move_down"),onClick:i[10]||(i[10]=m=>w(r.value,"down"))},{prepend:o(()=>[t(k,{style:{"padding-right":"10px"}},{default:o(()=>[t(V,{icon:"mdi-arrow-down"})]),_:1})]),_:1},8,["title"]),t(b),t(g,{title:l.$t("queue_delete"),onClick:i[11]||(i[11]=m=>w(r.value,"delete"))},{prepend:o(()=>[t(k,{style:{"padding-right":"10px"}},{default:o(()=>[t(V,{icon:"mdi-delete"})]),_:1})]),_:1},8,["title"]),t(b),((v=(a=r.value)==null?void 0:a.media_item)==null?void 0:v.media_type)==n(P).TRACK?(d(),q(g,{key:0,title:l.$t("show_info"),onClick:i[12]||(i[12]=m=>{var _;return(_=r.value)!=null&&_.media_item?j(r.value.media_item):""})},{prepend:o(()=>[t(k,{style:{"padding-right":"10px"}},{default:o(()=>[t(V,{icon:"mdi-information-outline"})]),_:1})]),_:1},8,["title"])):c("",!0),t(b)]}),_:1})]),_:1})):c("",!0)]),_:1})]),_:1},8,["modelValue","fullscreen"])])}}});export{Le as default};
