import{_ as I,f as h}from"./ItemsListing.vue_vue_type_script_setup_true_lang-42892a57.js";import{_ as y}from"./InfoHeader.vue_vue_type_style_index_0_lang-a6ed08c3.js";import{d as E,r as p,z as g,o as A,n as d,W as b,A as M,h as v,q as B,b as c,w as k,i as V,j as C,v as $,p as T}from"./index-ee8437d7.js";import{V as x,a as N}from"./VTabs-31f81146.js";import{V as U}from"./VDivider-4507c497.js";import"./vue-virtual-scroller.esm-b914cb3b.js";/* empty css                             */import"./ListviewItem-25f1d650.js";import"./_plugin-vue_export-helper-78c98fb5.js";import"./MediaItemThumb.vue_vue_type_style_index_0_lang-17a1a2e3.js";import"./VBtn-b96ed4d9.js";import"./VCardText-6a1c7759.js";import"./ProviderIcon.vue_vue_type_script_setup_true_lang-77828dd3.js";import"./VCard-8b0196fc.js";import"./forwardRefs-c136d9cb.js";import"./VMenu-41a392e9.js";import"./VLabel-8db56deb.js";import"./VCheckboxBtn-fb15dfa2.js";import"./VTooltip-29fa8f6f.js";import"./MediaItemContextMenu.vue_vue_type_style_index_0_lang-b0a334d6.js";import"./VToolbar-9efe4adb.js";import"./VSelect-5c229b12.js";import"./VDialog-49d874f5.js";import"./VRow-c108ec08.js";/* empty css              */import"./VAlert-4fd0fec3.js";import"./layout-56262c5d.js";const ne=E({__name:"TrackDetails",props:{itemId:null,provider:null,album:null},setup(w){const t=w,s=p(""),l=p(!1),r=p(),u=p(!0),f=async function(){console.log("props",t),r.value=await d.getTrack(t.itemId,t.provider,void 0,void 0,void 0,t.album),s.value="versions"};g(()=>t.itemId,a=>{a&&f()},{immediate:!0}),A(()=>{const a=d.subscribe_multi([b.MEDIA_ITEM_ADDED,b.MEDIA_ITEM_UPDATED],e=>{var m,n,i;const o=e.data;if(((m=r.value)==null?void 0:m.uri)==o.uri)l.value=!0;else for(const _ of o.provider_mappings)if(_.provider_domain==((n=r.value)==null?void 0:n.provider)&&_.item_id==((i=r.value)==null?void 0:i.item_id)){l.value=!0;break}});M(a)});const D=async function(a,e,o,m,n=!0){const i=await d.getTrackVersions(t.itemId,t.provider);return u.value=i.length>0,h(i,a,e,o,m,n)};return(a,e)=>(v(),B("section",null,[c(y,{item:r.value},null,8,["item"]),c(N,{modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=o=>s.value=o),"show-arrows":"",grow:"","hide-slider":""},{default:k(()=>[u.value?(v(),V(x,{key:0,value:"details"},{default:k(()=>[C($(a.$t("other_versions")),1)]),_:1})):T("",!0)]),_:1},8,["modelValue"]),c(U),u.value&&s.value=="versions"?(v(),V(I,{key:0,itemtype:"trackversions","parent-item":r.value,"show-providers":!0,"show-library":!1,"show-track-number":!1,"load-data":D,"sort-keys":["provider","sort_name","duration"],"update-available":l.value,onRefreshClicked:e[1]||(e[1]=o=>{f(),l.value=!1})},null,8,["parent-item","update-available"])):T("",!0)]))}});export{ne as default};
