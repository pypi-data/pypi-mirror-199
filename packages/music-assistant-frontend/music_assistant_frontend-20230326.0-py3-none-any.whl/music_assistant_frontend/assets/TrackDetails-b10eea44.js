import{_ as I,f as h}from"./ItemsListing.vue_vue_type_script_setup_true_lang-7fd323fc.js";import{_ as y}from"./InfoHeader.vue_vue_type_style_index_0_lang-fdcdfe95.js";import{d as E,r as p,z as g,o as A,n as d,W as k,A as M,h as v,q as B,b as c,w as V,i as b,j as C,v as $,p as T}from"./index-360c18c2.js";import{V as x,a as N}from"./VTabs-b1a9686e.js";import{V as U}from"./VDivider-96bedeb4.js";import"./vue-virtual-scroller.esm-6f253ead.js";/* empty css                             */import"./ListviewItem-cd0c5981.js";import"./_plugin-vue_export-helper-2cf9c33f.js";import"./MediaItemThumb.vue_vue_type_style_index_0_lang-f1d2752e.js";import"./VBtn-e2fc180e.js";import"./VCardText-11324a1e.js";import"./ProviderIcon.vue_vue_type_script_setup_true_lang-11d41a00.js";import"./VCard-0775ecfb.js";import"./forwardRefs-d5ef110d.js";import"./VMenu-126e0dc1.js";import"./VLabel-9a392132.js";import"./VCheckboxBtn-d3969214.js";import"./VTooltip-e44ab6a6.js";import"./MediaItemContextMenu.vue_vue_type_style_index_0_lang-48be2920.js";import"./VToolbar-e1217d04.js";import"./VSelect-43b82995.js";import"./VDialog-1d0fc2c5.js";import"./VRow-802e1dac.js";/* empty css              */import"./VAlert-7e1551d3.js";import"./layout-54f3d934.js";const ne=E({__name:"TrackDetails",props:{itemId:null,provider:null},setup(w){const o=w,s=p(""),l=p(!1),r=p(),u=p(!0),f=async function(){r.value=await d.getTrack(o.itemId,o.provider),s.value="versions"};g(()=>o.itemId,t=>{t&&f()},{immediate:!0}),A(()=>{const t=d.subscribe_multi([k.MEDIA_ITEM_ADDED,k.MEDIA_ITEM_UPDATED],e=>{var m,n,i;const a=e.data;if(((m=r.value)==null?void 0:m.uri)==a.uri)l.value=!0;else for(const _ of a.provider_mappings)if(_.provider_domain==((n=r.value)==null?void 0:n.provider)&&_.item_id==((i=r.value)==null?void 0:i.item_id)){l.value=!0;break}});M(t)});const D=async function(t,e,a,m,n=!0){const i=await d.getTrackVersions(o.itemId,o.provider);return u.value=i.length>0,h(i,t,e,a,m,n)};return(t,e)=>(v(),B("section",null,[c(y,{item:r.value},null,8,["item"]),c(N,{modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=a=>s.value=a),"show-arrows":"",grow:"","hide-slider":""},{default:V(()=>[u.value?(v(),b(x,{key:0,value:"details"},{default:V(()=>[C($(t.$t("other_versions")),1)]),_:1})):T("",!0)]),_:1},8,["modelValue"]),c(U),u.value&&s.value=="versions"?(v(),b(I,{key:0,itemtype:"trackversions","parent-item":r.value,"show-providers":!0,"show-library":!1,"show-track-number":!1,"load-data":D,"sort-keys":["provider","sort_name","duration"],"update-available":l.value,onRefreshClicked:e[1]||(e[1]=a=>{f(),l.value=!1})},null,8,["parent-item","update-available"])):T("",!0)]))}});export{ne as default};
