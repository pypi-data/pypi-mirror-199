(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5363],{58144:function(e,r,t){"use strict";var n=t(59499),s=t(26537),i=t(23256),o=t(43894),a=t(85893);function c(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?c(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}r.Z=function(e){var r=e.isOpen,t=e.onClose,n=e.onConfirm,c=e.title,d=e.message,u=e.cancelButtonText,h=e.cancelButtonThemingProps,p=e.continueButtonText,f=e.continueButtonThemingProps,m=e.isLoading,x=e.returnFocusOnClose,j=e.isCentered,b=e.testId,y=void 0===b?"confirmation-modal":b;return(0,a.jsxs)(s.u_,{isOpen:r,onClose:t,size:"lg",returnFocusOnClose:null===x||void 0===x||x,isCentered:j,children:[(0,a.jsx)(s.ZA,{}),(0,a.jsxs)(s.hz,{textAlign:"center",p:2,"data-testid":y,children:[c?(0,a.jsx)(s.xB,{fontWeight:"medium",children:c}):null,d?(0,a.jsx)(s.fe,{children:d}):null,(0,a.jsx)(s.mz,{children:(0,a.jsxs)(i.MI,{columns:2,width:"100%",children:[(0,a.jsx)(o.zx,l(l({variant:"outline",mr:3,onClick:t,"data-testid":"cancel-btn",isDisabled:m},h),{},{children:u||"Cancel"})),(0,a.jsx)(o.zx,l(l({colorScheme:"primary",onClick:n,"data-testid":"continue-btn",isLoading:m},f),{},{children:p||"Continue"}))]})})]})]})}},52313:function(e,r,t){"use strict";var n=t(59499),s=t(4730),i=t(81144),o=t(85893),a=["data","border"];function c(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?c(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}r.Z=function(e){var r=e.data,t=e.border,n=void 0===t?"partial":t,c=(0,s.Z)(e,a);return(0,o.jsxs)(i.mQ,l(l({colorScheme:"complimentary"},c),{},{children:[(0,o.jsx)(i.td,{width:"partial"===n?"max-content":void 0,children:r.map((function(e,r){return(0,o.jsx)(i.OK,{"data-testid":"tab-".concat(e.label),_selected:{fontWeight:"600",color:"complimentary.500",borderColor:"complimentary.500"},fontSize:c.fontSize,fontWeight:"500",color:"gray.500",isDisabled:e.isDisabled||!1,children:e.label},r)}))}),(0,o.jsx)(i.nP,{children:r.map((function(e,r){return(0,o.jsx)(i.x4,{px:0,"data-testid":"tab-panel-".concat(e.label),children:e.content},r)}))})]}))}},10867:function(e,r,t){"use strict";t.d(r,{Tg:function(){return o},uC:function(){return a}});var n=t(97142),s=t(65648),i=t(85893),o=function(e){return(0,n.C)(s.uu).filter((function(r){return e.includes(r)})).length>0},a=function(e){return(0,n.C)(s.C0).filter((function(r){return e.includes(r)})).length>0};r.ZP=function(e){var r=e.scopes,t=e.children;return o(r)?(0,i.jsx)(i.Fragment,{children:t}):null}},49743:function(e,r,t){"use strict";var n=t(59499),s=t(4730),i=t(30268),o=t(48591),a=t(43894),c=t(85893),l=["search","onChange","withIcon","withClear"];function d(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function u(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?d(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}r.Z=function(e){var r=e.search,t=e.onChange,n=e.withIcon,d=e.withClear,h=(0,s.Z)(e,l);return(0,c.jsxs)(i.BZ,{size:"sm",minWidth:"308px",children:[n?(0,c.jsx)(i.Z8,{pointerEvents:"none",children:(0,c.jsx)(o.PT,{color:"gray.300",w:"17px",h:"17px"})}):null,(0,c.jsx)(i.II,u({autoComplete:"off",type:"search",minWidth:200,size:"sm",borderRadius:"md",value:r,name:"search",onChange:function(e){return t(e.target.value)}},h)),d?(0,c.jsx)(i.xH,{width:"3.5rem",display:"flex",alignItems:"center",children:(0,c.jsx)(a.zx,{fontWeight:"light",size:"sm",onClick:function(){t("")},height:"95%",width:"95%",children:"Clear"})}):null]})}},70783:function(e,r,t){"use strict";t.d(r,{HK:function(){return i},VY:function(){return n.V}});var n=t(63719),s=t(65698),i=function(){var e=(0,n.V)().errorAlert;return{handleError:function(r){var t="An unexpected error occurred. Please try again.";(0,s.Ot)(r)?t=r.data.detail:(0,s.tB)(r)&&(t=r.data.detail[0].msg),e(t)}}};t(67294)},63719:function(e,r,t){"use strict";t.d(r,{V:function(){return u}});var n=t(59499),s=t(13450),i=t(26707),o=t(23256),a=t(93225),c=t(85893);function l(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?l(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var u=function(){var e=(0,s.pm)();return{errorAlert:function(r,t,n){var s=d(d({},n),{},{position:(null===n||void 0===n?void 0:n.position)||"top",render:function(e){var n=e.onClose;return(0,c.jsxs)(i.bZ,{alignItems:"normal",status:"error",children:[(0,c.jsx)(i.zM,{}),(0,c.jsxs)(o.xu,{children:[t&&(0,c.jsx)(i.Cd,{children:t}),(0,c.jsx)(i.X,{children:r})]}),(0,c.jsx)(a.P,{onClick:n,position:"relative",right:0,size:"sm",top:-1})]})}});null!==n&&void 0!==n&&n.id&&e.isActive(n.id)?e.update(n.id,s):e(s)},successAlert:function(r,t,n){var s=d(d({},n),{},{position:(null===n||void 0===n?void 0:n.position)||"top",render:function(e){var n=e.onClose;return(0,c.jsxs)(i.bZ,{alignItems:"normal",status:"success",variant:"subtle",children:[(0,c.jsx)(i.zM,{}),(0,c.jsxs)(o.xu,{children:[t&&(0,c.jsx)(i.Cd,{children:t}),(0,c.jsx)(i.X,{children:r})]}),(0,c.jsx)(a.P,{onClick:n,position:"relative",right:0,size:"sm",top:-1})]})}});null!==n&&void 0!==n&&n.id&&e.isActive(n.id)?e.update(n.id,s):e(s)}}}},10846:function(e,r,t){"use strict";t.d(r,{MA:function(){return d},Vo:function(){return h},t5:function(){return u}});var n=t(59499),s=t(23256),i=t(85893);function o(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function a(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var c=function(e){var r=e.message;return(0,i.jsxs)(s.xv,{"data-testid":"toast-success-msg",children:[(0,i.jsx)("strong",{children:"Success:"})," ",r]})},l=function(e){var r=e.message;return(0,i.jsxs)(s.xv,{"data-testid":"toast-error-msg",children:[(0,i.jsx)("strong",{children:"Error:"})," ",r]})},d={variant:"subtle",position:"top",description:"",duration:5e3,status:"success",isClosable:!0},u=function(e){var r=(0,i.jsx)(c,{message:e});return a(a({},d),{description:r})},h=function(e){var r=(0,i.jsx)(l,{message:e});return a(a({},d),{description:r,status:"error"})}},795:function(e,r,t){"use strict";t.d(r,{R:function(){return k},Z:function(){return z}});var n=t(23256),s=t(67294),i=t(89816),o=t(1902),a=t.n(o),c=t(85893),l=function(e){var r=e.columns,t=e.items,s=e.renderItem,o=(0,i.yo)(t,r);return(0,c.jsx)(n.xu,{children:o.map((function(e,t,i){var o=i.length;return(0,c.jsx)(n.xu,{className:a()["grid-row"],borderBottomWidth:o>1&&t===o-1&&e.length===r?"0.5px":void 0,children:(0,c.jsx)(n.MI,{columns:r,children:e.map((function(e){return(0,c.jsx)(n.xu,{className:a()["grid-item"],children:s(e)},JSON.stringify(e))}))})},JSON.stringify(e))}))})},d=t(49743),u=t(50029),h=t(16835),p=t(87794),f=t.n(p),m=t(97375),x=t(13450),j=t(37991),b=t(43894),y=t(48591),g=t(11163),v=t(97142),w=t(58144),O=t(65698),P=t(10846),C=t(32523),S=function(e){var r=e.system,t=(0,m.qY)(),s=t.isOpen,i=t.onOpen,o=t.onClose,a=(0,x.pm)(),l=(0,v.T)(),d=(0,g.useRouter)(),p=(0,C.DW)(),S=(0,h.Z)(p,1)[0],k=function(){var e=(0,u.Z)(f().mark((function e(){var t;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(r.fides_key);case 2:t=e.sent,(0,O.D4)(t)?a((0,P.Vo)((0,O.e$)(t.error))):a((0,P.t5)("Successfully deleted system")),o();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=""===r.name||null==r.name?r.fides_key:r.name;return(0,c.jsxs)(n.xu,{display:"flex","data-testid":"system-".concat(r.fides_key),children:[(0,c.jsxs)(n.xu,{flexGrow:1,p:4,children:[(0,c.jsx)(n.X6,{as:"h2",fontSize:"16px",mb:2,children:z}),(0,c.jsx)(n.xu,{color:"gray.600",fontSize:"14px",children:(0,c.jsx)(n.xv,{children:r.description})})]}),(0,c.jsxs)(j.v2,{children:[(0,c.jsx)(j.j2,{as:b.hU,icon:(0,c.jsx)(y.nX,{}),"aria-label":"more actions",variant:"unstyled",size:"sm","data-testid":"more-btn",m:1}),(0,c.jsxs)(j.qy,{children:[(0,c.jsx)(j.sN,{onClick:function(){l((0,C.db)(r)),d.push("/system/configure")},"data-testid":"edit-btn",children:"Edit"}),(0,c.jsx)(j.sN,{onClick:i,"data-testid":"delete-btn",children:"Delete"})]})]}),(0,c.jsx)(w.Z,{isOpen:s,onClose:o,onConfirm:k,title:"Delete ".concat(z),message:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(n.xv,{children:["You are about to permanently delete the system"," ",(0,c.jsx)(n.xv,{color:"complimentary.500",as:"span",fontWeight:"bold",children:z}),"."]}),(0,c.jsx)(n.xv,{children:"Are you sure you would like to continue?"})]})})]})},k=function(e,r){var t,n;return(null===(t=e.name)||void 0===t?void 0:t.toLocaleLowerCase().includes(r.toLocaleLowerCase()))||(null===(n=e.description)||void 0===n?void 0:n.toLocaleLowerCase().includes(r.toLocaleLowerCase()))},z=function(e){var r=e.systems,t=(0,s.useState)(""),i=t[0],o=t[1],a=(0,s.useMemo)((function(){return r?r.filter((function(e){return k(e,i)})):[]}),[r,i]);return r&&r.length?(0,c.jsxs)(n.xu,{"data-testid":"system-management",children:[(0,c.jsx)(n.xu,{mb:4,"data-testid":"system-filters",children:(0,c.jsx)(d.Z,{search:i,onChange:o,maxWidth:"30vw",placeholder:"Search system name or description","data-testid":"system-search",withIcon:!0})}),(0,c.jsx)(l,{columns:3,items:a,renderItem:function(e){return(0,c.jsx)(S,{system:e})}})]}):(0,c.jsx)("div",{"data-testid":"empty-state",children:"No systems registered."})}},78221:function(e,r,t){"use strict";var n=t(4730),s=t(50029),i=t(16835),o=t(87794),a=t.n(o),c=t(13450),l=t(26537),d=t(23256),u=t(43894),h=t(82175),p=t(11163),f=(t(67294),t(74231)),m=t(97142),x=t(18459),j=t(96016),b=t(65698),y=t(10846),g=t(43072),v=t(85893),w=["user"],O={username:"",usernameConfirmation:""};r.Z=function(e){var r=e.user,t=(0,n.Z)(e,w),o=t.isOpen,P=t.onClose,C=function(e){var r=e.id,t=e.username,n=e.onClose,o=(0,c.pm)(),l=(0,p.useRouter)(),d=(0,m.T)(),u=(0,g.I1)(),h=(0,i.Z)(u,1)[0],j=function(){var e=(0,s.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(r);case 2:t=e.sent,(0,b.D4)(t)?o((0,y.Vo)((0,b.e$)(t.error))):(o((0,y.t5)("Successfully deleted user")),n()),d((0,g.Vv)(void 0)),l.push(x.e3);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{handleDeleteUser:j,validationSchema:f.Ry().shape({username:f.Z_().required().oneOf([t],"Username must match this user's").label("Username"),usernameConfirmation:f.Z_().required().oneOf([f.iH("username")],"Usernames must match").label("Username confirmation")})}}({id:r.id,username:r.username,onClose:P}),S=C.handleDeleteUser,k=C.validationSchema;return(0,v.jsxs)(l.u_,{isCentered:!0,isOpen:o,onClose:P,children:[(0,v.jsx)(l.ZA,{}),(0,v.jsx)(l.hz,{"data-testid":"delete-user-modal",children:(0,v.jsx)(h.J9,{initialValues:O,validationSchema:k,onSubmit:S,children:function(e){var r=e.isSubmitting,t=e.dirty,n=e.isValid;return(0,v.jsxs)(h.l0,{children:[(0,v.jsx)(l.xB,{children:"Delete User"}),(0,v.jsx)(l.ol,{}),(0,v.jsx)(l.fe,{children:(0,v.jsxs)(d.Kq,{direction:"column",spacing:4,children:[(0,v.jsx)(j.j0,{name:"username",label:"Enter username"}),(0,v.jsx)(j.j0,{name:"usernameConfirmation",label:"Confirm username"})]})}),(0,v.jsx)(l.mz,{children:(0,v.jsxs)(u.hE,{size:"sm",spacing:"2",width:"100%",children:[(0,v.jsx)(u.zx,{onClick:P,variant:"outline",width:"50%",children:"Cancel"}),(0,v.jsx)(u.zx,{colorScheme:"primary",disabled:!t||!n,isLoading:r,type:"submit",width:"50%","data-testid":"submit-btn",children:"Delete User"})]})})]})}})})]})}},33278:function(e,r,t){"use strict";var n=t(23256),s=t(20440),i=t(41664),o=t.n(i),a=(t(67294),t(48057)),c=t(18459),l=t(85893);r.Z=function(e){var r=e.title,t=e.children;return(0,l.jsxs)(a.Z,{title:"User Management",children:[(0,l.jsxs)(n.X6,{fontSize:"2xl",fontWeight:"semibold",children:["User Management",(0,l.jsx)(n.xu,{mt:2,mb:7,children:(0,l.jsxs)(s.aG,{fontWeight:"medium",fontSize:"sm",children:[(0,l.jsx)(s.gN,{children:(0,l.jsx)(o(),{href:c.e3,passHref:!0,children:(0,l.jsx)(s.At,{href:c.e3,children:"Management"})})}),(0,l.jsx)(s.gN,{children:(0,l.jsx)(s.At,{href:"#",children:r})})]})})]}),t]})}},77979:function(e,r,t){"use strict";t.d(r,{Z:function(){return be}});var n=t(59499),s=t(4730),i=t(23256),o=t(41040),a=t(85893),c=function(){return(0,a.jsxs)(i.xu,{children:[(0,a.jsx)(i.xu,{pb:4,fontSize:"18px",fontWeight:"semibold",children:"Role Description"}),(0,a.jsx)(i.gC,{spacing:4,children:o.K.map((function(e){return(0,a.jsxs)(i.xu,{width:"100%",padding:"16px",backgroundColor:"blue.50",fontSize:"14px",children:[(0,a.jsx)(i.xu,{fontWeight:"semibold",children:e.label}),(0,a.jsx)(i.xu,{color:"gray.500",children:e.description})]},e.roleKey)}))})]})},l=t(97142),d=t(52313),u=t(50029),h=t(16835),p=t(87794),f=t.n(p),m=t(13450),x=t(44359),j=t(43894),b=t(10867),y=t(82175),g=t(41664),v=t.n(g),w=t(18459),O=t(65698),P=t(13230),C=t(10846),S=t(16227),k=t(97375),z=t(48591),Z=t(26537),D=t(27634),_=t(82350),E=t(67294),A=t(49743),R=t(67087),V=t(795),I=t(27812),U=t(78522),W=t(58144),q=t(26595),K=t(43072),T=function(){var e=(0,l.C)(K.Ux),r=(0,k.qY)(),t=r.isOpen,n=r.onOpen,s=r.onClose;(0,K.d6)(e,{skip:!e});var o=(0,l.C)(K.R$),c=(0,m.pm)(),d=(0,K.n_)(),p=(0,h.Z)(d,1)[0],x=function(){var r=(0,u.Z)(f().mark((function r(t){var n;return f().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,p({userId:e,systemKey:t.fides_key});case 4:n=r.sent,(0,q.isErrorResult)(n)?c((0,C.Vo)((0,O.e$)(n.error))):(c((0,C.t5)("Successfully removed system")),s());case 6:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();return 0===o.length?null:(0,a.jsxs)(U.iA,{size:"sm","data-testid":"assign-systems-delete-table",children:[(0,a.jsx)(U.hr,{children:(0,a.jsxs)(U.Tr,{children:[(0,a.jsx)(U.Th,{children:"System"}),(0,a.jsx)(U.Th,{})]})}),(0,a.jsx)(U.p3,{children:o.map((function(e){return(0,a.jsxs)(U.Tr,{_hover:{bg:"gray.50"},"data-testid":"row-".concat(e.fides_key),children:[(0,a.jsx)(U.Td,{children:e.name}),(0,a.jsxs)(U.Td,{children:[(0,a.jsx)(j.hU,{"aria-label":"Unassign system from user",icon:(0,a.jsx)(z.lr,{}),size:"xs",onClick:n,"data-testid":"unassign-btn"}),(0,a.jsx)(W.Z,{isOpen:t,onClose:s,onConfirm:function(){return x(e)},title:"Remove System",testId:"remove-".concat(e.fides_key,"-confirmation-modal"),continueButtonText:"Yes, Remove System",message:(0,a.jsx)(i.xv,{children:"Are you sure you want to remove this system?"})})]})]},e.fides_key)}))})]})},N=function(e){var r=e.allSystems,t=e.assignedSystems,n=e.onChange,s=function(e){var r=!!t.find((function(r){return r.fides_key===e.fides_key}));n(r?t.filter((function(r){return r.fides_key!==e.fides_key})):[].concat((0,I.Z)(t),[e]))};return(0,a.jsx)(i.xu,{overflowY:"auto",maxHeight:"300px",children:(0,a.jsxs)(U.iA,{size:"sm","data-testid":"assign-systems-table",maxHeight:"50vh",overflowY:"scroll",children:[(0,a.jsx)(U.hr,{position:"sticky",top:0,background:"white",zIndex:1,children:(0,a.jsxs)(U.Tr,{children:[(0,a.jsx)(U.Th,{children:"System"}),(0,a.jsx)(U.Th,{children:"Assign"})]})}),(0,a.jsx)(U.p3,{children:r.map((function(e){var r=!!t.find((function(r){return r.fides_key===e.fides_key}));return(0,a.jsxs)(U.Tr,{_hover:{bg:"gray.50"},"data-testid":"row-".concat(e.fides_key),children:[(0,a.jsx)(U.Td,{children:e.name}),(0,a.jsx)(U.Td,{children:(0,a.jsx)(_.r,{isChecked:r,onChange:function(){return s(e)},"data-testid":"assign-switch"})})]},e.fides_key)}))})]})})},L=function(e){var r=e.isOpen,t=e.onClose,n=(0,l.C)(K.Ux),s=(0,R.K3)().data;(0,K.d6)(n,{skip:!n});var o=(0,K.G$)(),c=(0,h.Z)(o,2),d=c[0],p=c[1].isLoading,x=(0,E.useState)(""),b=x[0],y=x[1],g=(0,l.C)(K.R$),v=(0,E.useState)(g),w=v[0],P=v[1],S=(0,m.pm)();(0,E.useEffect)((function(){P(g)}),[g]);var k=function(){var e=(0,u.Z)(f().mark((function e(){var r,s;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return r=w.map((function(e){return e.fides_key})),e.next=5,d({userId:n,fidesKeys:r});case 5:if(s=e.sent,!(0,O.D4)(s)){e.next=9;break}return S((0,C.Vo)((0,O.e$)(s.error))),e.abrupt("return");case 9:S((0,C.t5)("Updated users permissions")),t();case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=!s||0===s.length,I=(0,E.useMemo)((function(){return s?s.filter((function(e){return(0,V.R)(e,b)})):[]}),[s,b]),U=(0,E.useMemo)((function(){var e=new Set(w.map((function(e){return e.fides_key})));return I.every((function(r){return e.has(r.fides_key)}))}),[I,w]);return(0,a.jsxs)(Z.u_,{isOpen:r,onClose:t,size:"2xl",children:[(0,a.jsx)(Z.ZA,{}),(0,a.jsxs)(Z.hz,{p:8,"data-testid":"confirmation-modal",children:[(0,a.jsxs)(Z.xB,{fontWeight:"medium",display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,a.jsx)(i.xv,{children:"Assign systems"}),(0,a.jsxs)(i.Ct,{bg:"green.500",color:"white",px:1,children:["Assigned to ",g.length," systems"]})]}),(0,a.jsx)(Z.fe,{"data-testid":"assign-systems-modal-body",children:z?(0,a.jsx)(i.xv,{children:"No systems found"}):(0,a.jsxs)(i.Kq,{spacing:4,children:[(0,a.jsxs)(i.kC,{justifyContent:"space-between",children:[(0,a.jsx)(i.xv,{fontSize:"sm",flexGrow:1,fontWeight:"medium",children:"Assign systems in your organization to this user"}),(0,a.jsx)(i.xu,{children:(0,a.jsxs)(D.NI,{display:"flex",alignItems:"center",children:[(0,a.jsx)(D.lX,{fontSize:"sm",htmlFor:"assign-all-systems",mb:"0",children:"Assign all systems"}),(0,a.jsx)(_.r,{size:"sm",id:"assign-all-systems",isChecked:U,onChange:function(e){if(e.target.checked&&s)P(I);else{var r=s?s.filter((function(e){return!I.includes(e)})):[];P(r)}},"data-testid":"assign-all-systems-toggle"})]})})]}),(0,a.jsx)(A.Z,{search:b,onChange:y,placeholder:"Search for systems","data-testid":"system-search",withIcon:!0}),(0,a.jsx)(N,{allSystems:I,assignedSystems:w,onChange:P})]})}),(0,a.jsx)(Z.mz,{justifyContent:"flex-start",children:(0,a.jsxs)(j.hE,{size:"sm",children:[(0,a.jsx)(j.zx,{variant:"outline",mr:2,onClick:t,"data-testid":"cancel-btn",children:"Cancel"}),z?null:(0,a.jsx)(j.zx,{colorScheme:"primary",onClick:k,"data-testid":"confirm-btn",isLoading:p,children:"Confirm"})]})})]})]})},B=function(e){var r=e.label,t=e.roleKey,n=e.isSelected,s=e.isDisabled,o=(0,y.u6)().setFieldValue,c=(0,k.qY)(),l=s?"You do not have sufficient permissions to assign this role.":void 0;return n?(0,a.jsxs)(i.Kq,{borderRadius:"md",border:"1px solid",borderColor:"gray.200",p:4,backgroundColor:"gray.50","aria-selected":"true",spacing:4,"data-testid":"selected",children:[(0,a.jsxs)(i.kC,{alignItems:"center",justifyContent:"space-between",children:[(0,a.jsx)(i.xv,{fontSize:"md",fontWeight:"semibold",children:r}),(0,a.jsx)(z.St,{})]}),t!==S.A7.APPROVER?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i.kC,{alignItems:"center",children:[(0,a.jsx)(i.xv,{fontSize:"sm",fontWeight:"semibold",mr:1,children:"Assigned systems"}),(0,a.jsx)(P.Z,{label:"Assigned systems refer to those systems that have been specifically allocated to a user for management purposes. Users assigned to a system possess full edit permissions and are listed as the Data Steward for the respective system."})]}),(0,a.jsx)(j.zx,{disabled:s,title:l,colorScheme:"primary",size:"xs",width:"fit-content",onClick:c.onOpen,"data-testid":"assign-systems-btn",children:"Assign systems +"}),(0,a.jsx)(T,{}),c.isOpen?(0,a.jsx)(L,{isOpen:c.isOpen,onClose:c.onClose}):null]}):null]}):(0,a.jsx)(j.zx,{onClick:function(){o("roles",[t])},justifyContent:"start",variant:"outline",height:"inherit",p:4,"data-testid":"role-option-".concat(r),title:l,disabled:s,children:r})};function M(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}var Y={roles:[]},F=function(){var e,r=(0,m.pm)(),t=(0,l.C)(K.Ux),s=(0,K.gU)(null!==t&&void 0!==t?t:"",{skip:!t}),c=s.data,d=s.isLoading,p=(0,K.lD)(),g=(0,h.Z)(p,1)[0],k=function(){var e=(0,u.Z)(f().mark((function e(n){var s;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,g({user_id:t,payload:{scopes:null===c||void 0===c?void 0:c.scopes,roles:n.roles}});case 4:if(s=e.sent,!(0,O.D4)(s)){e.next=8;break}return r((0,C.Vo)((0,O.e$)(s.error))),e.abrupt("return");case 8:r((0,C.t5)("Permissions updated"));case 9:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),z=(0,b.uC)([S.A7.OWNER]);if(!t)return null;if(d)return(0,a.jsx)(x.$,{});if(!z&&null!==c&&void 0!==c&&null!==(e=c.roles)&&void 0!==e&&e.includes(S.A7.OWNER))return(0,a.jsx)(i.xv,{children:"You do not have sufficient access to change this user's permissions."});var Z=null!==c&&void 0!==c&&c.roles?{roles:c.roles}:Y;return(0,a.jsx)(y.J9,{onSubmit:k,initialValues:Z,enableReinitialize:!0,children:function(e){var r=e.values,t=e.isSubmitting,s=e.dirty;return(0,a.jsx)(y.l0,{children:(0,a.jsxs)(i.Kq,{spacing:7,children:[(0,a.jsxs)(i.Kq,{spacing:3,children:[(0,a.jsxs)(i.kC,{alignItems:"center",children:[(0,a.jsx)(i.xv,{fontSize:"sm",fontWeight:"semibold",mr:1,children:"User role"}),(0,a.jsx)(P.Z,{label:"A user's role in the organization determines what parts of the UI they can access and which functions are available to them."})]}),o.K.map((function(e){var t=r.roles.indexOf(e.roleKey)>=0;return(0,a.jsx)(B,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?M(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):M(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({isSelected:t,isDisabled:e.roleKey===S.A7.OWNER&&!z},e),e.roleKey)}))]}),(0,a.jsxs)(j.hE,{size:"sm",children:[(0,a.jsx)(v(),{href:w.e3,passHref:!0,children:(0,a.jsx)(j.zx,{variant:"outline",children:"Cancel"})}),(0,a.jsx)(j.zx,{colorScheme:"primary",type:"submit",isLoading:t,disabled:!s,"data-testid":"save-btn",children:"Save"})]})]})})}})},H=t(70783),$=t(78221),G=t(74231),J=t(96016),X=G.Z_().required().min(8,"Password must have at least eight characters.").matches(/[0-9]/,"Password must have at least one number.").matches(/[A-Z]/,"Password must have at least one capital letter.").matches(/[a-z]/,"Password must have at least one lowercase letter.").matches(/[\W]/,"Password must have at least one symbol."),Q=t(37161);function ee(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function re(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ee(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ee(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var te=G.Ry().shape({password:X.label("Password"),passwordConfirmation:G.Z_().required().oneOf([G.iH("password")],"Passwords must match").label("Password confirmation")}),ne={password:"",passwordConfirmation:""},se=function(e){var r=function(e){var r=(0,k.qY)(),t=(0,m.pm)(),n=(0,K.ls)(),s=(0,h.Z)(n,1)[0],i=function(){var n=(0,u.Z)(f().mark((function n(i){var o;return f().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s({id:e,new_password:i.password});case 2:o=n.sent,(0,q.isErrorResult)(o)?t((0,C.Vo)((0,O.e$)(o.error))):(t((0,C.t5)("Successfully reset user's password. Please inform the user of their new password.")),r.onClose());case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return re(re({},r),{},{handleResetPassword:i})}(e.id),t=r.handleResetPassword,n=r.isOpen,s=r.onClose,o=r.onOpen;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.zx,{variant:"outline",size:"sm",onClick:o,"data-testid":"reset-password-btn",children:"Reset password"}),(0,a.jsxs)(Z.u_,{isCentered:!0,isOpen:n,onClose:s,children:[(0,a.jsx)(Z.ZA,{}),(0,a.jsx)(Z.hz,{children:(0,a.jsx)(y.J9,{initialValues:ne,validationSchema:te,onSubmit:t,children:function(e){var r=e.isSubmitting,t=e.dirty,n=e.isValid;return(0,a.jsxs)(y.l0,{children:[(0,a.jsx)(Z.xB,{children:"Reset Password"}),(0,a.jsx)(Z.ol,{}),(0,a.jsx)(Z.fe,{children:(0,a.jsxs)(i.Kq,{direction:"column",spacing:4,children:[(0,a.jsx)(i.xv,{mb:2,children:"Choose a new password for this user."}),(0,a.jsx)(J.j0,{name:"password",label:"Password",placeholder:"********",type:"password",tooltip:"Password must contain at least 8 characters, 1 number, 1 capital letter, 1 lowercase letter, and at least 1 symbol."}),(0,a.jsx)(J.j0,{name:"passwordConfirmation",label:"Confirm Password",placeholder:"********",type:"password",tooltip:"Must match above password."})]})}),(0,a.jsx)(Z.mz,{children:(0,a.jsxs)(j.hE,{size:"sm",spacing:"2",width:"100%",children:[(0,a.jsx)(j.zx,{onClick:s,variant:"outline",width:"50%",children:"Cancel"}),(0,a.jsx)(j.zx,{colorScheme:"primary",disabled:!t||!n,isLoading:r,type:"submit",width:"50%","data-testid":"submit-btn",children:"Change Password"})]})})]})}})})]})]})},ie=t(30268);function oe(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function ae(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?oe(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):oe(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var ce=function(e){var r=function(e){var r=(0,k.qY)(),t=(0,m.pm)(),n=(0,E.useState)(""),s=n[0],i=n[1],o=(0,E.useState)(""),a=o[0],c=o[1],l=(0,K.ev)(),d=(0,h.Z)(l,2),p=d[0],x=d[1].isLoading,j=!!(e&&a&&s),b=function(){var n=(0,u.Z)(f().mark((function n(){return f().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:j&&p({id:e,old_password:s,new_password:a}).unwrap().then((function(){t((0,C.t5)("Password updated")),r.onClose()}));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return ae(ae({},r),{},{changePasswordValidation:j,handleChange:function(e){"oldPassword"===e.target.name?i(e.target.value):c(e.target.value)},handleChangePassword:b,isLoading:x,newPasswordValue:a,oldPasswordValue:s})}(e.id),t=r.changePasswordValidation,n=r.handleChange,s=r.handleChangePassword,o=r.isLoading,c=r.isOpen,l=r.newPasswordValue,d=r.oldPasswordValue,p=r.onClose,x=r.onOpen;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.zx,{variant:"outline",size:"sm",onClick:x,"data-testid":"update-password-btn",children:"Update password"}),(0,a.jsxs)(Z.u_,{isCentered:!0,isOpen:c,onClose:p,children:[(0,a.jsx)(Z.ZA,{}),(0,a.jsxs)(Z.hz,{children:[(0,a.jsx)(Z.xB,{children:"Update Password"}),(0,a.jsx)(Z.ol,{}),(0,a.jsx)(Z.fe,{pb:6,children:(0,a.jsxs)(i.Kq,{direction:"column",spacing:"15px",children:[(0,a.jsx)(D.NI,{children:(0,a.jsx)(ie.II,{isRequired:!0,name:"oldPassword",onChange:n,placeholder:"Old Password",type:"password",value:d,"data-testid":"input-oldPassword"})}),(0,a.jsx)(D.NI,{children:(0,a.jsx)(ie.II,{isRequired:!0,name:"newPassword",onChange:n,placeholder:"New Password",type:"password",value:l,"data-testid":"input-newPassword"})})]})}),(0,a.jsxs)(Z.mz,{children:[(0,a.jsx)(j.zx,{bg:"white",marginRight:"10px",onClick:p,size:"sm",variant:"solid",width:"50%",children:"Cancel"}),(0,a.jsx)(j.zx,{bg:"primary.800",color:"white",disabled:!t,isLoading:o,mr:3,onClick:s,size:"sm",type:"submit",variant:"solid",width:"50%","data-testid":"submit-btn",children:"Change Password"})]})]})]})]})},le=function(){var e=(0,l.C)(K.Ux),r=(0,l.C)(Q.dy),t=!!r&&r.id===e;return(0,a.jsx)(i.xu,{children:e?(0,a.jsxs)(i.Ug,{children:[t?(0,a.jsx)(ce,{id:e}):null,(0,a.jsx)(b.ZP,{scopes:[S.Sh.USER_PASSWORD_RESET],children:(0,a.jsx)(se,{id:e})})]}):null})};function de(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function ue(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?de(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):de(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var he={username:"",first_name:"",last_name:"",password:""},pe=G.Ry().shape({username:G.Z_().required().label("Username"),first_name:G.Z_().label("First name"),last_name:G.Z_().label("Last name"),password:X.label("Password")}),fe=function(e){var r=e.onSubmit,t=e.initialValues,n=e.canEditNames,s=e.canChangePassword,o=(0,m.pm)(),c=(0,l.T)(),d=(0,k.qY)(),h=(0,H.HK)().handleError,p=(0,l.C)(K.ZC),x=!p,b=!x&&!n,g=function(){var e=(0,u.Z)(f().mark((function e(t){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t);case 2:if(!(n=e.sent)||!("error"in n)){e.next=6;break}return h(n.error),e.abrupt("return");case 6:o((0,C.t5)("User ".concat(x?"created":"updated"))),n&&n.data&&c((0,K.Vv)(n.data.id));case 8:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),O=s||x?pe:pe.omit(["password"]);return(0,a.jsx)(y.J9,{onSubmit:g,initialValues:null!==t&&void 0!==t?t:he,validationSchema:O,children:function(e){var r=e.dirty,t=e.isSubmitting,n=e.isValid;return(0,a.jsx)(y.l0,{children:(0,a.jsxs)(i.Kq,{maxW:["xs","xs","100%"],width:"100%",spacing:7,children:[(0,a.jsxs)(i.Kq,{spacing:6,maxWidth:"55%",children:[(0,a.jsxs)(i.kC,{children:[(0,a.jsx)(i.xv,{display:"flex",alignItems:"center",fontSize:"sm",fontWeight:"semibold",children:"Profile"}),(0,a.jsx)(i.xu,{marginLeft:"auto",children:(0,a.jsxs)(i.Ug,{children:[(0,a.jsx)(le,{}),x?null:(0,a.jsxs)(i.xu,{children:[(0,a.jsx)(j.hU,{"aria-label":"delete",icon:(0,a.jsx)(z.lr,{}),size:"xs",onClick:d.onOpen,"data-testid":"delete-user-btn"}),(0,a.jsx)($.Z,ue({user:p},d))]})]})})]}),(0,a.jsx)(J.j0,{name:"username",label:"Username",variant:"block",placeholder:"Enter new username",disabled:!x,isRequired:!0}),(0,a.jsx)(J.j0,{name:"first_name",label:"First Name",variant:"block",placeholder:"Enter first name of user",disabled:b}),(0,a.jsx)(J.j0,{name:"last_name",label:"Last Name",variant:"block",placeholder:"Enter last name of user",disabled:b}),p?null:(0,a.jsx)(J.j0,{name:"password",label:"Password",variant:"block",placeholder:"********",type:"password",tooltip:"Password must contain at least 8 characters, 1 number, 1 capital letter, 1 lowercase letter, and at least 1 symbol.",isRequired:!0})]}),(0,a.jsxs)(j.hE,{size:"sm",children:[(0,a.jsx)(v(),{href:w.e3,passHref:!0,children:(0,a.jsx)(j.zx,{variant:"outline",mr:3,children:"Cancel"})}),(0,a.jsx)(j.zx,{type:"submit",bg:"primary.800",_hover:{bg:"primary.400"},_active:{bg:"primary.500"},colorScheme:"primary",disabled:!r||!n,isLoading:t,children:"Save"})]})]})})}})},me=["onSubmit","initialValues"];function xe(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function je(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?xe(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):xe(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var be=function(e){var r=e.onSubmit,t=e.initialValues,n=(0,s.Z)(e,me),o=(0,l.C)(K.Ux);(0,K.Fk)(o,{skip:!o});var u=[{label:"Profile",content:(0,a.jsx)(fe,je({onSubmit:r,initialValues:t},n))},{label:"Permissions",content:(0,a.jsxs)(i.kC,{gap:"97px",children:[(0,a.jsx)(i.xu,{w:{base:"100%",md:"65%",xl:"55%"},children:(0,a.jsx)(F,{})}),(0,a.jsx)(i.xu,{w:{base:"100%",md:"35%",xl:"45%"},children:(0,a.jsx)(c,{})})]}),isDisabled:!o}];return(0,a.jsx)(d.Z,{data:u})}},41040:function(e,r,t){"use strict";t.d(r,{K:function(){return s}});var n=t(16227),s=[{label:"Owner",permissions_label:"Owner",roleKey:n.A7.OWNER,description:"Owners have view and edit access to the whole organization and can create new users"},{label:"Contributor",permissions_label:"Contributor",roleKey:n.A7.CONTRIBUTOR,description:"Contributors can create new users and have view and edit access to the whole organization apart from configuring storage and messaging"},{label:"Viewer",permissions_label:"Viewer",roleKey:n.A7.VIEWER,description:"Viewers have view access to the Data Map and all systems"},{label:"Viewer & Approver",permissions_label:"Viewer & Approver",roleKey:n.A7.VIEWER_AND_APPROVER,description:"Viewer & Approvers have view access to the Data Map but can also manage Privacy Requests"},{label:"Approver",permissions_label:"Approver",roleKey:n.A7.APPROVER,description:"Approvers can only access the Privacy Requests portal to manage requests"}]},26595:function(e,r,t){"use strict";t.d(r,{isAPIError:function(){return n.Bw},isErrorResult:function(){return n.D4}});var n=t(27396)},1902:function(e){e.exports={"grid-row":"BorderGrid_grid-row__gzSVf","grid-item":"BorderGrid_grid-item__7gUTW"}}}]);