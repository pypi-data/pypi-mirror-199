name: wsclean_pol
image: stimela/wsclean
command: wsclean
info: WSClean imager, polarized mode

defaults:
  weight: "briggs 0."
  column: DATA
  pol: IQUV

policies:
  positional: false
  prefix: "-"
  replace: { '_': '-' }

inputs:
  _use: lib.params.wsclean.base_inputs

  pol: 
    choices: [IQ, IV, IQUV]
  join-polarizations:
    dtype: bool

outputs:
  _use: lib.params.wsclean.base_outputs

  restored: 
    info: Restored images
    dtype: List[File]
    implicit: "=GLOB({current.prefix}-[0-9][0-9][0-9][0-9]-[IQUV]-image.fits)"
    must_exist: false
  residual:
    dtype: List[File]
    implicit: "=GLOB({current.prefix}-[0-9][0-9][0-9][0-9]-[IQUV]-residual.fits)"
    must_exist: false
  model:
    info: Model images
    dtype: List[File]
    implicit: "=GLOB({current.prefix}-[0-9][0-9][0-9][0-9]-[IQUV]-model.fits)"
    must_exist: false
  restored-mfs-i:
    info: Restored MFS images
    dtype: File
    implicit: "=GLOB({current.prefix}-MFS-I-image.fits)"
    must_exist: false
  restored-mfs:
    info: Restored MFS images
    dtype: List[File]
    implicit: "=GLOB({current.prefix}-MFS-[IQUV]-image.fits)"
    must_exist: false
  residual-mfs:
    info: Residual MFS images
    dtype: List[File]
    implicit: "=GLOB({current.prefix}-MFS-[IQUV]-residual.fits)"
    must_exist: false
  residual-mfs-stokes:
    v:
      info: Residual MFS images
      dtype: File
      implicit: "=GLOB({current.prefix}-MFS-V-residual.fits)"
      must_exist: false
  model-mfs:
    info: Model MFS images
    dtype: List[File]
    implicit: "=GLOB({current.prefix}-MFS-[IQUV]-model.fits)"
    must_exist: false
  dirty-mfs:
    info: Dirty MFS images
    dtype: List[File]
    implicit: "=GLOB({current.prefix}-MFS-[IQUV]-dirty.fits)"
    must_exist: false
  dirty:
    stokes:
      info: Dirty images
      dtype: List[File]
      implicit: "=GLOB({current.prefix}-[0-9][0-9][0-9][0-9]-[IQUV]-dirty.fits)"
      must_exist: false
    i:
      info: Dirty I image
      dtype: File
      implicit: "{current.prefix}-I-dirty.fits"
      must_exist: false
    v:
      info: Dirty V image
      dtype: File
      implicit: "{current.prefix}-V-dirty.fits"
      must_exist: false
