"use strict";(self.webpackChunkjupyterlab_bpmn=self.webpackChunkjupyterlab_bpmn||[]).push([[124],{7124:(t,e,n)=>{n.r(e),n.d(e,{default:()=>U});const i=/^class[ {]/;function r(t){return Array.isArray(t)}function o(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function s(...t){1===t.length&&r(t[0])&&(t=t[0]);const e=(t=[...t]).pop();return e.$inject=t,e}const h=/constructor\s*[^(]*\(\s*([^)]*)\)/m,a=/^(?:async\s+)?(?:function\s*[^(]*)?(?:\(\s*([^)]*)\)|(\w+))/m,c=/\/\*([^*]*)\*\//m;function u(t){if("function"!=typeof t)throw new Error(`Cannot annotate "${t}". Expected a function!`);const e=t.toString().match(function(t){return i.test(t.toString())}(t)?h:a);if(!e)return[];const n=e[1]||e[2];return n&&n.split(",").map((t=>{const e=t.match(c);return(e&&e[1]||t).trim()}))||[]}function p(t,e){e=e||{get:function(t,e){if(n.push(t),!1===e)return null;throw c(`No provider for "${t}"!`)}};const n=[],i=this._providers=Object.create(e._providers||null),h=this._instances=Object.create(null),a=h.injector=this,c=function(t){const e=n.join(" -> ");return n.length=0,new Error(e?`${t} (Resolving: ${e})`:t)};function f(t,r){if(!i[t]&&-1!==t.indexOf(".")){const e=t.split(".");let n=f(e.shift());for(;e.length;)n=n[e.shift()];return n}if(o(h,t))return h[t];if(o(i,t)){if(-1!==n.indexOf(t))throw n.push(t),c("Cannot resolve circular dependency!");return n.push(t),h[t]=i[t][0](i[t][1]),n.pop(),h[t]}return e.get(t,r)}function d(t,e){if(void 0===e&&(e={}),"function"!=typeof t){if(!r(t))throw c(`Cannot invoke "${t}". Expected a function!`);t=s(t.slice())}return{fn:t,dependencies:(t.$inject||u(t)).map((t=>o(e,t)?e[t]:f(t)))}}function y(t){const{fn:e,dependencies:n}=d(t);return new(Function.prototype.bind.apply(e,[null].concat(n)))}function _(t,e,n){const{fn:i,dependencies:r}=d(t,n);return i.apply(e,r)}function v(t){return s((e=>t.get(e)))}function g(t,e){if(e&&e.length){const n=Object.create(null),r=Object.create(null),o=[],s=[],h=[];let a,c,u,p;for(let t in i)a=i[t],-1!==e.indexOf(t)&&("private"===a[2]?(c=o.indexOf(a[3]),-1===c?(u=a[3].createChild([],e),p=v(u),o.push(a[3]),s.push(u),h.push(p),n[t]=[p,t,"private",u]):n[t]=[h[c],t,"private",s[c]]):n[t]=[a[2],a[1]],r[t]=!0),"factory"!==a[2]&&"type"!==a[2]||!a[1].$scope||e.forEach((e=>{-1!==a[1].$scope.indexOf(e)&&(n[t]=[a[2],a[1]],r[e]=!0)}));e.forEach((t=>{if(!r[t])throw new Error('No provider for "'+t+'". Cannot use provider from the parent!')})),t.unshift(n)}return new p(t,a)}const m={factory:_,type:y,value:function(t){return t}};function w(t,e){const n=t.__init__||[];return function(){n.forEach((t=>{"string"==typeof t?e.get(t):e.invoke(t)}))}}function x(t){const e=t.__exports__;if(e){const n=t.__modules__,r=Object.keys(t).reduce(((e,n)=>("__exports__"!==n&&"__modules__"!==n&&"__init__"!==n&&"__depends__"!==n&&(e[n]=t[n]),e)),Object.create(null)),o=g((n||[]).concat(r)),h=s((function(t){return o.get(t)}));e.forEach((function(t){i[t]=[h,t,"private",o]}));const a=(t.__init__||[]).slice();return a.unshift((function(){o.init()})),w(t=Object.assign({},t,{__init__:a}),o)}return Object.keys(t).forEach((function(e){if("__init__"===e||"__depends__"===e)return;if("private"===t[e][2])return void(i[e]=t[e]);const n=t[e][0],r=t[e][1];i[e]=[m[n],l(n,r),n]})),w(t,a)}function E(t,e){return-1!==t.indexOf(e)||-1!==(t=(e.__depends__||[]).reduce(E,t)).indexOf(e)?t:t.concat(e)}this.get=f,this.invoke=_,this.instantiate=y,this.createChild=g,this.init=function(t){const e=t.reduce(E,[]).map(x);let n=!1;return function(){n||(n=!0,e.forEach((t=>t())))}}(t)}function l(t,e){return"value"!==t&&r(e)&&(e=s(e.slice())),e}var f=n(1066),d=n(6858),y=n(8230),_=n(7487),v=n(8670),g=n(1490),m=1;function w(t,e){d.Z.call(this,t,m),this.CONNECTION_STYLE=e.style(["no-fill"],{strokeWidth:5,stroke:"fuchsia"}),this.SHAPE_STYLE=e.style({fill:"white",stroke:"fuchsia",strokeWidth:2}),this.FRAME_STYLE=e.style(["no-fill"],{stroke:"fuchsia",strokeDasharray:4,strokeWidth:2})}(0,f.Z)(w,d.Z),w.prototype.canRender=function(){return!0},w.prototype.drawShape=function(t,e,n){var i=(0,_.Ue)("rect");return(0,_.Lj)(i,{x:0,y:0,width:e.width||0,height:e.height||0}),(0,g.He)(e)?(0,_.Lj)(i,(0,v.f0)({},this.FRAME_STYLE,n||{})):(0,_.Lj)(i,(0,v.f0)({},this.SHAPE_STYLE,n||{})),(0,_.R3)(t,i),i},w.prototype.drawConnection=function(t,e,n){var i=(0,y.W5)(e.waypoints,(0,v.f0)({},this.CONNECTION_STYLE,n||{}));return(0,_.R3)(t,i),i},w.prototype.getShapePath=function(t){var e=t.x,n=t.y,i=t.width,r=[["M",e,n],["l",i,0],["l",0,t.height],["l",-i,0],["z"]];return(0,y.KO)(r)},w.prototype.getConnectionPath=function(t){var e,n,i=t.waypoints,r=[];for(e=0;n=i[e];e++)n=n.original||n,r.push([0===e?"M":"L",n.x,n.y]);return(0,y.KO)(r)},w.$inject=["eventBus","styles"];const x={__init__:["defaultRenderer"],defaultRenderer:["type",w],styles:["type",function(){var t={"no-fill":{fill:"none"},"no-border":{strokeOpacity:0},"no-events":{pointerEvents:"none"}},e=this;this.cls=function(t,e,n){var i=this.style(e,n);return(0,v.f0)(i,{class:t})},this.style=function(e,n){(0,v.kJ)(e)||n||(n=e,e=[]);var i=(0,v.u4)(e,(function(e,n){return(0,v.f0)(e,t[n]||{})}),{});return n?(0,v.f0)(i,n):i},this.computeStyle=function(t,n,i){return(0,v.kJ)(n)||(i=n,n=[]),e.style(n||[],(0,v.f0)({},i,t||{}))}}]};var E=n(9674),b=n(943),R=n(935);function L(t,e){return Math.round(t*e)/e}function j(t){return(0,v.hj)(t)?t+"px":t}function k(t,e,n){const i=(0,_.Ue)("g");(0,_.Sh)(i).add(e);const r=void 0!==n?n:t.childNodes.length-1;return t.insertBefore(i,t.childNodes[r]||null),i}const C={shape:["x","y","width","height"],connection:["waypoints"]};function B(t,e,n,i){this._eventBus=e,this._elementRegistry=i,this._graphicsFactory=n,this._rootsIdx=0,this._layers={},this._planes=[],this._rootElement=null,this._init(t||{})}function S(t,e){const n="matrix("+e.a+","+e.b+","+e.c+","+e.d+","+e.e+","+e.f+")";t.setAttribute("transform",n)}B.$inject=["config.canvas","eventBus","graphicsFactory","elementRegistry"],B.prototype._init=function(t){const e=this._eventBus,n=this._container=function(t){const e=(t=(0,v.f0)({},{width:"100%",height:"100%"},t)).container||document.body,n=document.createElement("div");return n.setAttribute("class","djs-container djs-parent"),(0,E.i5)(n,{position:"relative",overflow:"hidden",width:j(t.width),height:j(t.height)}),e.appendChild(n),n}(t),i=this._svg=(0,_.Ue)("svg");(0,_.Lj)(i,{width:"100%",height:"100%"}),(0,_.R3)(n,i);const r=this._viewport=k(i,"viewport");!1!==t.deferUpdate&&(this._viewboxChanged=(0,v.Ds)((0,v.ak)(this._viewboxChanged,this),300)),e.on("diagram.init",(function(){e.fire("canvas.init",{svg:i,viewport:r})}),this),e.on(["shape.added","connection.added","shape.removed","connection.removed","elements.changed","root.set"],(function(){delete this._cachedViewbox}),this),e.on("diagram.destroy",500,this._destroy,this),e.on("diagram.clear",500,this._clear,this)},B.prototype._destroy=function(t){this._eventBus.fire("canvas.destroy",{svg:this._svg,viewport:this._viewport});const e=this._container.parentNode;e&&e.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._planes,delete this._rootElement,delete this._viewport},B.prototype._clear=function(){this._elementRegistry.getAll().forEach((t=>{const e=(0,g.oL)(t);"root"===e?this.removeRootElement(t):this._removeElement(t,e)})),this._planes=[],this._rootElement=null,delete this._cachedViewbox},B.prototype.getDefaultLayer=function(){return this.getLayer("base",0)},B.prototype.getLayer=function(t,e){if(!t)throw new Error("must specify a name");let n=this._layers[t];if(n||(n=this._layers[t]=this._createLayer(t,e)),void 0!==e&&n.index!==e)throw new Error("layer <"+t+"> already created at index <"+e+">");return n.group},B.prototype._getChildIndex=function(t){return(0,v.u4)(this._layers,(function(e,n){return n.visible&&t>=n.index&&e++,e}),0)},B.prototype._createLayer=function(t,e){void 0===e&&(e=1);const n=this._getChildIndex(e);return{group:k(this._viewport,"layer-"+t,n),index:e,visible:!0}},B.prototype.showLayer=function(t){if(!t)throw new Error("must specify a name");const e=this._layers[t];if(!e)throw new Error("layer <"+t+"> does not exist");const n=this._viewport,i=e.group,r=e.index;if(e.visible)return i;const o=this._getChildIndex(r);return n.insertBefore(i,n.childNodes[o]||null),e.visible=!0,i},B.prototype.hideLayer=function(t){if(!t)throw new Error("must specify a name");const e=this._layers[t];if(!e)throw new Error("layer <"+t+"> does not exist");const n=e.group;return e.visible?((0,_.Od)(n),e.visible=!1,n):n},B.prototype._removeLayer=function(t){const e=this._layers[t];e&&(delete this._layers[t],(0,_.Od)(e.group))},B.prototype.getActiveLayer=function(){const t=this._findPlaneForRoot(this.getRootElement());return t?t.layer:null},B.prototype.findRoot=function(t){if("string"==typeof t&&(t=this._elementRegistry.get(t)),!t)return;const e=this._findPlaneForRoot(function(t){for(;t.parent;)t=t.parent;return t}(t))||{};return e.rootElement},B.prototype.getRootElements=function(){return this._planes.map((function(t){return t.rootElement}))},B.prototype._findPlaneForRoot=function(t){return(0,v.sE)(this._planes,(function(e){return e.rootElement===t}))},B.prototype.getContainer=function(){return this._container},B.prototype._updateMarker=function(t,e,n){let i;t.id||(t=this._elementRegistry.get(t)),i=this._elementRegistry._elements[t.id],i&&((0,v.Ed)([i.gfx,i.secondaryGfx],(function(t){t&&(n?(0,_.Sh)(t).add(e):(0,_.Sh)(t).remove(e))})),this._eventBus.fire("element.marker.update",{element:t,gfx:i.gfx,marker:e,add:!!n}))},B.prototype.addMarker=function(t,e){this._updateMarker(t,e,!0)},B.prototype.removeMarker=function(t,e){this._updateMarker(t,e,!1)},B.prototype.hasMarker=function(t,e){t.id||(t=this._elementRegistry.get(t));const n=this.getGraphics(t);return(0,_.Sh)(n).has(e)},B.prototype.toggleMarker=function(t,e){this.hasMarker(t,e)?this.removeMarker(t,e):this.addMarker(t,e)},B.prototype.getRootElement=function(){const t=this._rootElement;return t||this._planes.length?t:this.setRootElement(this.addRootElement(null))},B.prototype.addRootElement=function(t){const e=this._rootsIdx++;t||(t={id:"__implicitroot_"+e,children:[],isImplicit:!0});const n=t.layer="root-"+e;this._ensureValid("root",t);const i=this.getLayer(n,0);return this.hideLayer(n),this._addRoot(t,i),this._planes.push({rootElement:t,layer:i}),t},B.prototype.removeRootElement=function(t){if("string"==typeof t&&(t=this._elementRegistry.get(t)),this._findPlaneForRoot(t))return this._removeRoot(t),this._removeLayer(t.layer),this._planes=this._planes.filter((function(e){return e.rootElement!==t})),this._rootElement===t&&(this._rootElement=null),t},B.prototype.setRootElement=function(t,e){if((0,v.$K)(e))throw new Error("override not supported");if(t===this._rootElement)return;let n;if(!t)throw new Error("rootElement required");return n=this._findPlaneForRoot(t),n||(t=this.addRootElement(t)),this._setRoot(t),t},B.prototype._removeRoot=function(t){const e=this._elementRegistry,n=this._eventBus;n.fire("root.remove",{element:t}),n.fire("root.removed",{element:t}),e.remove(t)},B.prototype._addRoot=function(t,e){const n=this._elementRegistry,i=this._eventBus;i.fire("root.add",{element:t}),n.add(t,e),i.fire("root.added",{element:t,gfx:e})},B.prototype._setRoot=function(t,e){const n=this._rootElement;n&&(this._elementRegistry.updateGraphics(n,null,!0),this.hideLayer(n.layer)),t&&(e||(e=this._findPlaneForRoot(t).layer),this._elementRegistry.updateGraphics(t,this._svg,!0),this.showLayer(t.layer)),this._rootElement=t,this._eventBus.fire("root.set",{element:t})},B.prototype._ensureValid=function(t,e){if(!e.id)throw new Error("element must have an id");if(this._elementRegistry.get(e.id))throw new Error("element <"+e.id+"> already exists");const n=C[t];if(!(0,v.yW)(n,(function(t){return void 0!==e[t]})))throw new Error("must supply { "+n.join(", ")+" } with "+t)},B.prototype._setParent=function(t,e,n){(0,b.IH)(e.children,t,n),t.parent=e},B.prototype._addElement=function(t,e,n,i){n=n||this.getRootElement();const r=this._eventBus,o=this._graphicsFactory;this._ensureValid(t,e),r.fire(t+".add",{element:e,parent:n}),this._setParent(e,n,i);const s=o.create(t,e,i);return this._elementRegistry.add(e,s),o.update(t,e,s),r.fire(t+".added",{element:e,gfx:s}),e},B.prototype.addShape=function(t,e,n){return this._addElement("shape",t,e,n)},B.prototype.addConnection=function(t,e,n){return this._addElement("connection",t,e,n)},B.prototype._removeElement=function(t,e){const n=this._elementRegistry,i=this._graphicsFactory,r=this._eventBus;if(t=n.get(t.id||t))return r.fire(e+".remove",{element:t}),i.remove(t),(0,b.Od)(t.parent&&t.parent.children,t),t.parent=null,r.fire(e+".removed",{element:t}),n.remove(t),t},B.prototype.removeShape=function(t){return this._removeElement(t,"shape")},B.prototype.removeConnection=function(t){return this._removeElement(t,"connection")},B.prototype.getGraphics=function(t,e){return this._elementRegistry.getGraphics(t,e)},B.prototype._changeViewbox=function(t){this._eventBus.fire("canvas.viewbox.changing"),t.apply(this),this._cachedViewbox=null,this._viewboxChanged()},B.prototype._viewboxChanged=function(){this._eventBus.fire("canvas.viewbox.changed",{viewbox:this.viewbox()})},B.prototype.viewbox=function(t){if(void 0===t&&this._cachedViewbox)return this._cachedViewbox;const e=this._viewport,n=this.getSize();let i,r,o,s,h,a,c;return t?(this._changeViewbox((function(){h=Math.min(n.width/t.width,n.height/t.height);const i=this._svg.createSVGMatrix().scale(h).translate(-t.x,-t.y);(0,_.vs)(e,i)})),t):(o=this._rootElement?this.getActiveLayer():null,i=o&&o.getBBox()||{},s=(0,_.vs)(e),r=s?s.matrix:(0,_.wz)(),h=L(r.a,1e3),a=L(-r.e||0,1e3),c=L(-r.f||0,1e3),t=this._cachedViewbox={x:a?a/h:0,y:c?c/h:0,width:n.width/h,height:n.height/h,scale:h,inner:{width:i.width||0,height:i.height||0,x:i.x||0,y:i.y||0},outer:n})},B.prototype.scroll=function(t){const e=this._viewport;let n=e.getCTM();return t&&this._changeViewbox((function(){t=(0,v.f0)({dx:0,dy:0},t||{}),n=this._svg.createSVGMatrix().translate(t.dx,t.dy).multiply(n),S(e,n)})),{x:n.e,y:n.f}},B.prototype.scrollToElement=function(t,e){let n=100;"string"==typeof t&&(t=this._elementRegistry.get(t));const i=this.findRoot(t);i!==this.getRootElement()&&this.setRootElement(i),e||(e={}),"number"==typeof e&&(n=e),e={top:e.top||n,right:e.right||n,bottom:e.bottom||n,left:e.left||n};const r=(0,g.jY)(t),o=(0,R.JA)(r),s=this.viewbox(),h=this.zoom();let a,c;s.y+=e.top/h,s.x+=e.left/h,s.width-=(e.right+e.left)/h,s.height-=(e.bottom+e.top)/h;const u=(0,R.JA)(s);if(r.width<s.width&&r.height<s.height){const t=Math.max(0,o.right-u.right),e=Math.min(0,o.left-u.left),n=Math.max(0,o.bottom-u.bottom),i=Math.min(0,o.top-u.top);a=t||e,c=n||i}else a=r.x-s.x,c=r.y-s.y;this.scroll({dx:-a*h,dy:-c*h})},B.prototype.zoom=function(t,e){if(!t)return this.viewbox(t).scale;if("fit-viewport"===t)return this._fitViewport(e);let n,i;return this._changeViewbox((function(){"object"!=typeof e&&(n=this.viewbox().outer,e={x:n.width/2,y:n.height/2}),i=this._setZoom(t,e)})),L(i.a,1e3)},B.prototype._fitViewport=function(t){const e=this.viewbox(),n=e.outer,i=e.inner;let r,o;return i.x>=0&&i.y>=0&&i.x+i.width<=n.width&&i.y+i.height<=n.height&&!t?o={x:0,y:0,width:Math.max(i.width+i.x,n.width),height:Math.max(i.height+i.y,n.height)}:(r=Math.min(1,n.width/i.width,n.height/i.height),o={x:i.x+(t?i.width/2-n.width/r/2:0),y:i.y+(t?i.height/2-n.height/r/2:0),width:n.width/r,height:n.height/r}),this.viewbox(o),this.viewbox(!1).scale},B.prototype._setZoom=function(t,e){const n=this._svg,i=this._viewport,r=n.createSVGMatrix(),o=n.createSVGPoint();let s,h,a,c,u;a=i.getCTM();const p=a.a;return e?(s=(0,v.f0)(o,e),h=s.matrixTransform(a.inverse()),c=r.translate(h.x,h.y).scale(1/p*t).translate(-h.x,-h.y),u=a.multiply(c)):u=r.scale(t),S(this._viewport,u),u},B.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight}},B.prototype.getAbsoluteBBox=function(t){const e=this.viewbox();let n;return n=t.waypoints?this.getGraphics(t).getBBox():t,{x:n.x*e.scale-e.x*e.scale,y:n.y*e.scale-e.y*e.scale,width:n.width*e.scale,height:n.height*e.scale}},B.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire("canvas.resized")};var O="data-element-id";function M(t){this._elements={},this._eventBus=t}M.$inject=["eventBus"],M.prototype.add=function(t,e,n){var i=t.id;this._validateId(i),(0,_.Lj)(e,O,i),n&&(0,_.Lj)(n,O,i),this._elements[i]={element:t,gfx:e,secondaryGfx:n}},M.prototype.remove=function(t){var e=this._elements,n=t.id||t,i=n&&e[n];i&&((0,_.Lj)(i.gfx,O,""),i.secondaryGfx&&(0,_.Lj)(i.secondaryGfx,O,""),delete e[n])},M.prototype.updateId=function(t,e){this._validateId(e),"string"==typeof t&&(t=this.get(t)),this._eventBus.fire("element.updateId",{element:t,newId:e});var n=this.getGraphics(t),i=this.getGraphics(t,!0);this.remove(t),t.id=e,this.add(t,n,i)},M.prototype.updateGraphics=function(t,e,n){var i=t.id||t,r=this._elements[i];return n?r.secondaryGfx=e:r.gfx=e,e&&(0,_.Lj)(e,O,i),e},M.prototype.get=function(t){var e;e="string"==typeof t?t:t&&(0,_.Lj)(t,O);var n=this._elements[e];return n&&n.element},M.prototype.filter=function(t){var e=[];return this.forEach((function(n,i){t(n,i)&&e.push(n)})),e},M.prototype.find=function(t){for(var e=this._elements,n=Object.keys(e),i=0;i<n.length;i++){var r=e[n[i]],o=r.element;if(t(o,r.gfx))return o}},M.prototype.getAll=function(){return this.filter((function(t){return t}))},M.prototype.forEach=function(t){var e=this._elements;Object.keys(e).forEach((function(n){var i=e[n],r=i.element,o=i.gfx;return t(r,o)}))},M.prototype.getGraphics=function(t,e){var n=t.id||t,i=this._elements[n];return i&&(e?i.secondaryGfx:i.gfx)},M.prototype._validateId=function(t){if(!t)throw new Error("element must have an id");if(this._elements[t])throw new Error("element with id "+t+" already added")};var G=n(5149),P="__fn",V=Array.prototype.slice;function A(){this._listeners={},this.on("diagram.destroy",1,this._destroy,this)}function I(){}A.prototype.on=function(t,e,n,i){if(t=(0,v.kJ)(t)?t:[t],(0,v.mf)(e)&&(i=n,n=e,e=1e3),!(0,v.hj)(e))throw new Error("priority must be a number");var r=n;i&&((r=(0,v.ak)(n,i))[P]=n[P]||n);var o=this;t.forEach((function(t){o._addListener(t,{priority:e,callback:r,next:null})}))},A.prototype.once=function(t,e,n,i){var r=this;if((0,v.mf)(e)&&(i=n,n=e,e=1e3),!(0,v.hj)(e))throw new Error("priority must be a number");function o(){o.__isTomb=!0;var e=n.apply(i,arguments);return r.off(t,o),e}o[P]=n,this.on(t,e,o)},A.prototype.off=function(t,e){t=(0,v.kJ)(t)?t:[t];var n=this;t.forEach((function(t){n._removeListener(t,e)}))},A.prototype.createEvent=function(t){var e=new I;return e.init(t),e},A.prototype.fire=function(t,e){var n,i,r,o;if(o=V.call(arguments),"object"==typeof t&&(t=(e=t).type),!t)throw new Error("no event type specified");if(i=this._listeners[t]){n=e instanceof I?e:this.createEvent(e),o[0]=n;var s=n.type;t!==s&&(n.type=t);try{r=this._invokeListeners(n,o,i)}finally{t!==s&&(n.type=s)}return void 0===r&&n.defaultPrevented&&(r=!1),r}},A.prototype.handleError=function(t){return!1===this.fire("error",{error:t})},A.prototype._destroy=function(){this._listeners={}},A.prototype._invokeListeners=function(t,e,n){for(var i;n&&!t.cancelBubble;)i=this._invokeListener(t,e,n),n=n.next;return i},A.prototype._invokeListener=function(t,e,n){var i;if(n.callback.__isTomb)return i;try{i=function(t,e){return t.apply(null,e)}(n.callback,e),void 0!==i&&(t.returnValue=i,t.stopPropagation()),!1===i&&t.preventDefault()}catch(t){if(!this.handleError(t))throw console.error("unhandled error in event listener",t),t}return i},A.prototype._addListener=function(t,e){var n,i=this._getListeners(t);if(i){for(;i;){if(i.priority<e.priority)return e.next=i,void(n?n.next=e:this._setListeners(t,e));n=i,i=i.next}n.next=e}else this._setListeners(t,e)},A.prototype._getListeners=function(t){return this._listeners[t]},A.prototype._setListeners=function(t,e){this._listeners[t]=e},A.prototype._removeListener=function(t,e){var n,i,r,o=this._getListeners(t);if(e)for(;o;)n=o.next,(r=o.callback)!==e&&r[P]!==e||(i?i.next=n:this._setListeners(t,n)),i=o,o=n;else this._setListeners(t,null)},I.prototype.stopPropagation=function(){this.cancelBubble=!0},I.prototype.preventDefault=function(){this.defaultPrevented=!0},I.prototype.init=function(t){(0,v.f0)(this,t||{})};var N=n(2023),F=n(2168);function T(t,e){this._eventBus=t,this._elementRegistry=e}function $(t,e,n){var i=n||e.firstChild;t!==i&&e.insertBefore(t,i)}T.$inject=["eventBus","elementRegistry"],T.prototype._getChildrenContainer=function(t){var e,n=this._elementRegistry.getGraphics(t);return t.parent?(e=(0,N.G)(n))||(e=(0,_.Ue)("g"),(0,_.Sh)(e).add("djs-children"),(0,_.R3)(n.parentNode,e)):e=n,e},T.prototype._clear=function(t){var e=(0,N.s)(t);return(0,E.ZH)(e),e},T.prototype._createContainer=function(t,e,n,i){var r=(0,_.Ue)("g");(0,_.Sh)(r).add("djs-group"),void 0!==n?$(r,e,e.childNodes[n]):(0,_.R3)(e,r);var o=(0,_.Ue)("g");(0,_.Sh)(o).add("djs-element"),(0,_.Sh)(o).add("djs-"+t),i&&(0,_.Sh)(o).add("djs-frame"),(0,_.R3)(r,o);var s=(0,_.Ue)("g");return(0,_.Sh)(s).add("djs-visual"),(0,_.R3)(o,s),o},T.prototype.create=function(t,e,n){var i=this._getChildrenContainer(e.parent);return this._createContainer(t,i,n,(0,g.He)(e))},T.prototype.updateContainments=function(t){var e,n=this,i=this._elementRegistry;e=(0,v.u4)(t,(function(t,e){return e.parent&&(t[e.parent.id]=e.parent),t}),{}),(0,v.Ed)(e,(function(t){var e=t.children;if(e){var r=n._getChildrenContainer(t);(0,v.Ed)(e.slice().reverse(),(function(t){$(i.getGraphics(t).parentNode,r)}))}}))},T.prototype.drawShape=function(t,e){return this._eventBus.fire("render.shape",{gfx:t,element:e})},T.prototype.getShapePath=function(t){return this._eventBus.fire("render.getShapePath",t)},T.prototype.drawConnection=function(t,e){return this._eventBus.fire("render.connection",{gfx:t,element:e})},T.prototype.getConnectionPath=function(t){return this._eventBus.fire("render.getConnectionPath",t)},T.prototype.update=function(t,e,n){if(e.parent){var i=this._clear(n);if("shape"===t)this.drawShape(i,e),(0,F.Iu)(n,e.x,e.y);else{if("connection"!==t)throw new Error("unknown type: "+t);this.drawConnection(i,e)}e.hidden?(0,_.Lj)(n,"display","none"):(0,_.Lj)(n,"display","block")}},T.prototype.remove=function(t){var e=this._elementRegistry.getGraphics(t);(0,_.Od)(e.parentNode)};const z={__depends__:[x],__init__:["canvas"],canvas:["type",B],elementRegistry:["type",M],elementFactory:["type",G.Z],eventBus:["type",A],graphicsFactory:["type",T]};function U(t,e){this.injector=e=e||function(t){return e=[{config:["value",t=t||{}]},z].concat(t.modules||[]),(n=new p(e)).init(),n;var e,n}(t),this.get=e.get,this.invoke=e.invoke,this.get("eventBus").fire("diagram.init")}U.prototype.destroy=function(){this.get("eventBus").fire("diagram.destroy")},U.prototype.clear=function(){this.get("eventBus").fire("diagram.clear")}}}]);